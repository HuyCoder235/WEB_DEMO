<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Th√°m Hi·ªÉm ƒê·ªông V·∫≠t Qu√°i D·ªã</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #1c2526;
            color: #e0e0e0;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .container {
            max-width: 900px;
            background-color: #2e3b3e;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
        }
        h1 {
            text-align: center;
            color: #00b7eb;
            text-shadow: 0 0 5px #00b7eb;
        }
        .stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            background-color: #3a4a4e;
            padding: 10px;
            border-radius: 5px;
        }
        .stat {
            font-weight: bold;
        }
        .story-text {
            line-height: 1.6;
            margin-bottom: 20px;
            font-size: 1.1em;
        }
        .dialogue {
            background-color: #4a5a5e;
            padding: 10px;
            border-left: 4px solid #00b7eb;
            margin: 10px 0;
        }
        .inventory {
            background-color: #4a5a5e;
            padding: 10px;
            margin-bottom: 20px;
            border-radius: 5px;
        }
        .choices {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .choice-btn {
            background-color: #00b7eb;
            color: #1c2526;
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s;
        }
        .choice-btn:hover {
            background-color: #008bb0;
        }
        .ending {
            font-weight: bold;
            color: #ff4500;
            margin-top: 20px;
            text-align: center;
        }
        .restart-btn {
            background-color: #228b22;
            margin-top: 10px;
        }
        .restart-btn:hover {
            background-color: #1a6b1a;
        }
        .timer {
            color: #ff4500;
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Th√°m Hi·ªÉm ƒê·ªông V·∫≠t Qu√°i D·ªã</h1>
        <div id="stats" class="stats">
            <span class="stat">Tinh th·∫ßn: <span id="morale">100</span>%</span>
            <span class="stat">S·ª©c kh·ªèe: <span id="health">100</span>%</span>
            <span class="stat">D·ªØ li·ªáu: <span id="data">0</span></span>
            <span class="stat">Nguy hi·ªÉm: <span id="danger">10</span>%</span>
        </div>
        <div id="inventory" class="inventory">T√†i nguy√™n: S√∫ng g√¢y m√™ (3 ƒë·∫°n), Dao ph·∫´u thu·∫≠t, ƒê√®n pin</div>
        <div id="timer" class="timer"></div>
        <div id="story-text" class="story-text"></div>
        <div id="choices" class="choices"></div>
        <div id="ending" class="ending"></div>
    </div>

    <script>
        let stats = {
            morale: 100,
            health: 100,
            data: 0,
            danger: 10
        };

        let inventory = {
            tranquilizer: 3,
            knife: 1,
            flashlight: 1,
            medkit: 0,
            battery: 0,
            chemical: 0,
            sample: 0,
            drive: 0,
            signal: 0,
            tools: ["S√∫ng g√¢y m√™ (3 ƒë·∫°n)", "Dao ph·∫´u thu·∫≠t", "ƒê√®n pin"]
        };

        const storyNodes = {
            start: {
                text: "Tr·ª±c thƒÉng h·∫° c√°nh tr√™n b√£i ƒë·∫•t tr·ªëng g·∫ßn Isola Tenebris, h√≤n ƒë·∫£o ch√¨m trong s∆∞∆°ng m√π. B·∫°n, m·ªôt nh√† sinh v·∫≠t h·ªçc, b∆∞·ªõc xu·ªëng, mang theo s√∫ng g√¢y m√™, dao ph·∫´u thu·∫≠t, v√† ƒë√®n pin. CƒÉn c·ª© nghi√™n c·ª©u ph√≠a tr∆∞·ªõc hoang t√†n, c·ª≠a k√≠nh v·ª° v·ª•n, m√°u loang tr√™n t∆∞·ªùng. B·∫°n t·ª± nh·ªß: 'M√πi t·ª≠ kh√≠ ·ªü ƒë√¢y... m√¨nh ph·∫£i c·∫©n th·∫≠n.' Nhi·ªám v·ª•: ƒëi·ªÅu tra th√≠ nghi·ªám X13, thu th·∫≠p d·ªØ li·ªáu, v√† s·ªëng s√≥t. B·∫°n nghe ti·∫øng r√≠t qu√°i d·ªã t·ª´ xa.",
                timeLimit: 60,
                choices: [
                    { text: "ƒêi v√†o ph√≤ng th√≠ nghi·ªám", next: "lab_entry", effects: { morale: -10, danger: 20 } },
                    { text: "Kh√°m ph√° khu r·ª´ng b√™n c·∫°nh", next: "forest_entry", effects: { morale: -5, danger: 30 } },
                    { text: "Ki·ªÉm tra cƒÉn c·ª© b√™n ngo√†i", next: "check_base", effects: { morale: 5, health: -5 } }
                ]
            },
            check_base: {
                text: "B·∫°n ki·ªÉm tra khu v·ª±c quanh cƒÉn c·ª©. M·ªôt email in v·ªôi tr√™n b√†n vi·∫øt: 'X13 ƒë√£ tho√°t, ch√∫ng ta m·∫•t ki·ªÉm so√°t!' B·∫°n t√¨m th·∫•y m·ªôt b·ªô s∆° c·ª©u, nh∆∞ng ti·∫øng r√≠t t·ª´ r·ª´ng khi·∫øn b·∫°n l·∫°nh g√°y. 'M√¨nh kh√¥ng th·ªÉ ·ªü ƒë√¢y l√¢u,' b·∫°n nghƒ©.",
                effects: { inventory: { medkit: 1 }, morale: -5 },
                choices: [
                    { text: "ƒêi v√†o ph√≤ng th√≠ nghi·ªám", next: "lab_entry", effects: { morale: -10, danger: 20 } },
                    { text: "Kh√°m ph√° khu r·ª´ng", next: "forest_entry", effects: { morale: -5, danger: 30 } },
                    { text: "Ngh·ªâ ng∆°i ƒë·ªÉ l·∫•y tinh th·∫ßn", next: "rest_base", effects: { morale: 10, health: 10 } }
                ]
            },
            rest_base: {
                text: "B·∫°n ng·ªìi ngh·ªâ trong g√≥c cƒÉn c·ª©, d√πng b·ªô s∆° c·ª©u ƒë·ªÉ bƒÉng b√≥ v√†i v·∫øt x∆∞·ªõc. Tinh th·∫ßn b·∫°n ·ªïn ƒë·ªãnh h∆°n, nh∆∞ng c√°i ƒë√≥i b·∫Øt ƒë·∫ßu c·ªìn c√†o. 'M√¨nh c·∫ßn h√†nh ƒë·ªông tr∆∞·ªõc khi qu√° mu·ªôn,' b·∫°n t·ª± nh·ªß.",
                effects: { health: 20, morale: 10 },
                choices: [
                    { text: "ƒêi v√†o ph√≤ng th√≠ nghi·ªám", next: "lab_entry", effects: { morale: -10, danger: 20 } },
                    { text: "Kh√°m ph√° khu r·ª´ng", next: "forest_entry", effects: { morale: -5, danger: 30 } },
                    { text: "T√¨m th·ª©c ƒÉn trong cƒÉn c·ª©", next: "find_food", effects: { health: -10, morale: -5 } }
                ]
            },
            find_food: {
                text: "B·∫°n l·ª•c l·ªçi cƒÉn c·ª©, t√¨m ƒë∆∞·ª£c m·ªôt thanh nƒÉng l∆∞·ª£ng h·∫øt h·∫°n. ƒÇn n√≥ l√†m b·∫°n ƒë·ª° ƒë√≥i, nh∆∞ng v·ªã h√≥a h·ªçc khi·∫øn b·∫°n kh√≥ ch·ªãu. 'Ch·∫Øc kh√¥ng ch·∫øt ƒë√¢u... ƒë√∫ng kh√¥ng?' b·∫°n t·ª± h·ªèi. Ti·∫øng r√≠t t·ª´ r·ª´ng g·∫ßn h∆°n.",
                effects: { health: 10, morale: -5 },
                choices: [
                    { text: "ƒêi v√†o ph√≤ng th√≠ nghi·ªám", next: "lab_entry", effects: { morale: -10, danger: 20 } },
                    { text: "Kh√°m ph√° khu r·ª´ng", next: "forest_entry", effects: { morale: -5, danger: 30 } }
                ]
            },
            lab_entry: {
                text: "B·∫°n b∆∞·ªõc v√†o ph√≤ng th√≠ nghi·ªám, kh√¥ng kh√≠ n·∫∑ng m√πi h√≥a ch·∫•t. ·ªêng nghi·ªám v·ª° v·ª•n kh·∫Øp s√†n, v√† m·ªôt nh·∫≠t k√Ω c≈© n·∫±m tr√™n b√†n. B·∫°n ƒë·ªçc: 'X13 l√† t∆∞∆°ng lai... nh∆∞ng ch√∫ng t√¥i ƒë√£ ƒëi qu√° xa.' C√≥ ti·∫øng b∆∞·ªõc ch√¢n n·∫∑ng n·ªÅ ·ªü h√†nh lang ph√≠a sau. B·∫°n c·∫£m th·∫•y tim ƒë·∫≠p m·∫°nh.",
                effects: { data: 15, morale: -10, danger: 30 },
                choices: [
                    { text: "ƒê·ªçc k·ªπ nh·∫≠t k√Ω", next: "read_journal", effects: { morale: -5, data: 10 } },
                    { text: "ƒêi ƒë·∫øn khu l∆∞u tr·ªØ DNA", next: "dna_storage", effects: { morale: -10, danger: 40 } },
                    { text: "Tr·ªën v√†o ph√≤ng ph·ª•", next: "aux_lab", effects: { morale: 5, danger: 20 } }
                ]
            },
            read_journal: {
                text: "Nh·∫≠t k√Ω vi·∫øt: 'X13 l√† sinh v·∫≠t b√°n ng∆∞·ªùi, k·∫øt h·ª£p gen th√∫ v√† tr√≠ kh√¥n nh√¢n lo·∫°i. Nh∆∞ng n√≥ h·ªçc qu√° nhanh... v√† ph·∫£n b·ªôi ch√∫ng t√¥i.' B·∫°n ghi ch√∫ th√¥ng tin, nh∆∞ng ti·∫øng g·∫ßm r√∫ g·∫ßn h∆°n. 'N√≥ bi·∫øt m√¨nh ·ªü ƒë√¢y,' b·∫°n nghƒ©, tay run khi c·∫ßm dao.",
                effects: { data: 10, morale: -10 },
                choices: [
                    { text: "ƒêi ƒë·∫øn khu l∆∞u tr·ªØ DNA", next: "dna_storage", effects: { morale: -10, danger: 40 } },
                    { text: "Tr·ªën v√†o ph√≤ng ph·ª•", next: "aux_lab", effects: { morale: 5, danger: 20 } },
                    { text: "Chu·∫©n b·ªã ƒë·ªëi ƒë·∫ßu", next: "prepare_fight", effects: { morale: -20, danger: 50 } }
                ]
            },
            aux_lab: {
                text: "B·∫°n tr·ªën v√†o ph√≤ng th√≠ nghi·ªám ph·ª•, t√¨m th·∫•y c√¥ng th·ª©c vaccine ch·ªëng k√Ω sinh X13. Nh∆∞ng thi·∫øu b√¨nh x·ªãt h√≥a h·ªçc ƒë·ªÉ ch·∫ø t·∫°o. M·ªôt ti·∫øng r√≠t vang l√™n ‚Äì th·ª±c v·∫≠t di chuy·ªÉn ƒëang b√≤ tr√™n tr·∫ßn. B·∫°n th√¨ th·∫ßm: 'Ch·∫øt ti·ªát, ch√∫ng ·ªü kh·∫Øp n∆°i!'",
                effects: { data: 10, morale: -10 },
                choices: [
                    { text: "T√¨m b√¨nh x·ªãt h√≥a h·ªçc", next: "find_chemical", effects: { morale: -10, danger: 30 } },
                    { text: "Ch·∫°y ƒë·∫øn khu l∆∞u tr·ªØ DNA", next: "dna_storage", effects: { morale: -10, danger: 40 } },
                    { text: "ƒê·ªëi ph√≥ th·ª±c v·∫≠t", next: "fight_plant", effects: { health: -20, morale: -15 } }
                ]
            },
            find_chemical: {
                text: "B·∫°n t√¨m th·∫•y b√¨nh x·ªãt h√≥a h·ªçc trong t·ªß kh√≥a. D√πng n√≥, b·∫°n v√¥ hi·ªáu h√≥a th·ª±c v·∫≠t di chuy·ªÉn, thu ƒë∆∞·ª£c m·∫´u enzyme c·ªßa ch√∫ng. 'C√°i n√†y c√≥ th·ªÉ gi√∫p ch·∫ø vaccine,' b·∫°n nghƒ©, nh∆∞ng h∆°i th·ªü n·∫∑ng n·ªÅ v√¨ kh√≠ ƒë·ªôc r√≤ r·ªâ trong ph√≤ng.",
                effects: { inventory: { chemical: 1, sample: 1 }, data: 10, health: -10 },
                choices: [
                    { text: "Ch·∫ø vaccine", next: "make_vaccine", effects: { morale: 20, data: 15 } },
                    { text: "ƒêi ƒë·∫øn khu l∆∞u tr·ªØ DNA", next: "dna_storage", effects: { morale: -10, danger: 40 } },
                    { text: "Ngh·ªâ ng∆°i", next: "rest_lab", effects: { morale: 10, health: 10 } }
                ]
            },
            fight_plant: {
                text: "B·∫°n d√πng dao ph·∫´u thu·∫≠t ch√©m th·ª±c v·∫≠t, nh∆∞ng enzyme c·ªßa n√≥ phun v√†o tay b·∫°n, g√¢y b·ªèng r√°t. B·∫°n tho√°t ƒë∆∞·ª£c, nh∆∞ng c∆° th·ªÉ y·∫øu ƒëi. 'M√¨nh kh√¥ng th·ªÉ ti·∫øp t·ª•c nh∆∞ th·∫ø n√†y,' b·∫°n r√™n r·ªâ.",
                effects: { health: -30, morale: -20 },
                choices: [
                    { text: "T√¨m b√¨nh x·ªãt h√≥a h·ªçc", next: "find_chemical", effects: { morale: -10, danger: 30 } },
                    { text: "ƒêi ƒë·∫øn khu l∆∞u tr·ªØ DNA", next: "dna_storage", effects: { morale: -10, danger: 40 } },
                    { text: "Ngh·ªâ ng∆°i", next: "rest_lab", effects: { morale: 10, health: 10 } }
                ]
            },
            make_vaccine: {
                text: "B·∫°n k·∫øt h·ª£p m·∫´u enzyme v√† b√¨nh x·ªãt h√≥a h·ªçc, t·∫°o ra m·ªôt li·ªÅu vaccine th√¥ s∆°. 'N·∫øu r·ªùi ƒë·∫£o, m√¨nh c√≥ th·ªÉ c·ª©u h√†ng tri·ªáu ng∆∞·ªùi,' b·∫°n nghƒ©, c·∫£m th·∫•y hy v·ªçng. Nh∆∞ng ti·∫øng g·∫ßm c·ªßa X13 vang l√™n ƒë√¢u ƒë√≥ g·∫ßn ƒë√¢y.",
                effects: { data: 20, morale: 30, inventory: { tools: ["Vaccine th√¥"] } },
                choices: [
                    { text: "ƒêi ƒë·∫øn khu l∆∞u tr·ªØ DNA", next: "dna_storage", effects: { morale: -10, danger: 40 } },
                    { text: "T√¨m ƒë∆∞·ªùng tho√°t ƒë·∫£o", next: "escape_island", effects: { morale: -5, danger: 30 } },
                    { text: "ƒê·ªëi ƒë·∫ßu X13", next: "confront_alpha", effects: { morale: -20, danger: 50 } }
                ]
            },
            forest_entry: {
                text: "R·ª´ng r·∫≠m bao quanh cƒÉn c·ª© ƒë·∫ßy ti·∫øng r√≠t qu√°i d·ªã. B·∫°n ph√°t hi·ªán m·ªôt sinh v·∫≠t d·ªã d·∫°ng ‚Äì lo√†i k√Ω sinh ƒëa x√∫c tu ‚Äì ƒëang b√≤ tr√™n c√¢y. N√≥ quay ƒë·∫ßu, x√∫c tu gi·∫≠t gi·∫≠t. B·∫°n th√¨ th·∫ßm: 'ƒê·ª´ng c·ª≠ ƒë·ªông... ƒë·ª´ng c·ª≠ ƒë·ªông...' Tim b·∫°n ƒë·∫≠p th√¨nh th·ªãch.",
                timeLimit: 30,
                choices: [
                    { text: "Ch·∫°y tr·ªën", next: "escape_parasite", effects: { morale: -10, health: -10 } },
                    { text: "·∫®n n·∫•p", next: "hide_parasite", effects: { morale: -5, danger: 20 } },
                    { text: "ƒê·ªëi ƒë·∫ßu v·ªõi s√∫ng g√¢y m√™", next: "fight_parasite", effects: { inventory: { tranquilizer: -1 }, morale: -15 } }
                ]
            },
            escape_parasite: {
                text: "B·∫°n ch·∫°y th·ª•c m·∫°ng, c√†nh c√¢y qu·∫•t v√†o m·∫∑t. K√Ω sinh ƒëu·ªïi theo, nh∆∞ng b·∫°n tr·ªën v√†o m·ªôt l√πm c√¢y. Khi n√≥ b·ªè ƒëi, b·∫°n th·ªü ph√†o, nh∆∞ng c∆° th·ªÉ run r·∫©y. 'M√¨nh kh√¥ng th·ªÉ b·∫•t c·∫©n th·∫ø n·ªØa,' b·∫°n nghƒ©.",
                effects: { morale: -10, health: -10 },
                choices: [
                    { text: "Quay l·∫°i cƒÉn c·ª©", next: "lab_entry", effects: { morale: -10, danger: 20 } },
                    { text: "Kh√°m ph√° s√¢u h∆°n trong r·ª´ng", next: "deep_forest", effects: { morale: -10, danger: 40 } },
                    { text: "Thu th·∫≠p m·∫´u k√Ω sinh", next: "collect_parasite", effects: { data: 10, morale: -10 } }
                ]
            },
            hide_parasite: {
                text: "B·∫°n n√≠n th·ªü, ·∫©n sau m·ªôt th√¢n c√¢y. K√Ω sinh b√≤ qua, x√∫c tu qu√©t s√°t m·∫∑t b·∫°n. Khi n√≥ r·ªùi ƒëi, b·∫°n thu ƒë∆∞·ª£c m·ªôt m·∫©u x√∫c tu r∆°i ra. 'C√°i n√†y c√≥ gi√° tr·ªã nghi√™n c·ª©u,' b·∫°n nghƒ©, nh∆∞ng tim v·∫´n ƒë·∫≠p lo·∫°n.",
                effects: { data: 10, inventory: { sample: 1 }, morale: -5 },
                choices: [
                    { text: "Quay l·∫°i cƒÉn c·ª©", next: "lab_entry", effects: { morale: -10, danger: 20 } },
                    { text: "Kh√°m ph√° s√¢u h∆°n trong r·ª´ng", next: "deep_forest", effects: { morale: -10, danger: 40 } },
                    { text: "Ngh·ªâ ng∆°i", next: "rest_forest", effects: { morale: 10, health: 10 } }
                ]
            },
            fight_parasite: {
                text: () => {
                    if (inventory.tranquilizer > 0) {
                        return {
                            text: "B·∫°n b·∫Øn s√∫ng g√¢y m√™, l√†m k√Ω sinh b·∫•t ƒë·ªông. B·∫°n nhanh ch√≥ng l·∫•y m·∫´u x√∫c tu v√† ch·∫°y tho√°t. 'May m·∫Øn l·∫ßn n√†y, nh∆∞ng ƒë·∫°n kh√¥ng c√≤n nhi·ªÅu,' b·∫°n nghƒ©.",
                            effects: { data: 15, inventory: { sample: 1 }, morale: 10 },
                            choices: [
                                { text: "Quay l·∫°i cƒÉn c·ª©", next: "lab_entry", effects: { morale: -10, danger: 20 } },
                                { text: "Kh√°m ph√° s√¢u h∆°n trong r·ª´ng", next: "deep_forest", effects: { morale: -10, danger: 40 } },
                                { text: "Ngh·ªâ ng∆°i", next: "rest_forest", effects: { morale: 10, health: 10 } }
                            ]
                        };
                    } else {
                        return {
                            text: "S√∫ng g√¢y m√™ h·∫øt ƒë·∫°n! K√Ω sinh lao t·ªõi, x√∫c tu b√°m v√†o c·ªï b·∫°n. B·∫°n v√πng v·∫´y, nh∆∞ng n√≥ chi·∫øm l·∫•y c∆° th·ªÉ b·∫°n.",
                            ending: "Bi·∫øn D·ªã Ending: B·ªã k√Ω sinh ki·ªÉm so√°t, b·∫°n tr·ªü th√†nh qu√°i v·∫≠t."
                        };
                    }
                }
            },
            collect_parasite: {
                text: "B·∫°n c·∫©n th·∫≠n thu m·∫´u x√∫c tu t·ª´ ch·ªó k√Ω sinh b·ªè l·∫°i. M·∫´u v·∫≠t c√≥ gi√° tr·ªã, nh∆∞ng b·∫°n c·∫£m th·∫•y √°nh m·∫Øt g√¨ ƒë√≥ ƒëang theo d√µi t·ª´ b√≥ng t·ªëi. 'M√¨nh c·∫ßn r·ªùi kh·ªèi ƒë√¢y,' b·∫°n th√¨ th·∫ßm.",
                effects: { data: 10, inventory: { sample: 1 }, morale: -10 },
                choices: [
                    { text: "Quay l·∫°i cƒÉn c·ª©", next: "lab_entry", effects: { morale: -10, danger: 20 } },
                    { text: "Kh√°m ph√° s√¢u h∆°n trong r·ª´ng", next: "deep_forest", effects: { morale: -10, danger: 40 } },
                    { text: "Ngh·ªâ ng∆°i", next: "rest_forest", effects: { morale: 10, health: 10 } }
                ]
            },
            deep_forest: {
                text: "R·ª´ng c√†ng l√∫c c√†ng t·ªëi, kh√¥ng kh√≠ n·∫∑ng m√πi t·ª≠ kh√≠. B·∫°n ph√°t hi·ªán t·ªï c·ªßa lo√†i k√Ω sinh, h√†ng ch·ª•c x√∫c tu ngoe ngu·∫©y trong b√≥ng t·ªëi. ƒê·ªôt nhi√™n, m·ªôt sinh v·∫≠t t√†ng h√¨nh hi·ªán ra khi m√°u t·ª´ v·∫øt x∆∞·ªõc c·ªßa b·∫°n d√≠nh v√†o n√≥. 'Ch·∫øt ti·ªát, n√≥ ·ªü ngay ƒë√¢y!' b·∫°n h√©t th·∫ßm.",
                timeLimit: 30,
                choices: [
                    { text: "D√πng m√°u ƒë·ªÉ d·ª• n√≥", next: "bait_invisible", effects: { health: -15, morale: -10 } },
                    { text: "Ch·∫°y tho√°t", next: "escape_invisible", effects: { morale: -10, health: -10 } },
                    { text: "D√πng s√∫ng g√¢y m√™", next: "shoot_invisible", effects: { inventory: { tranquilizer: -1 }, morale: -15 } }
                ]
            },
            bait_invisible: {
                text: "B·∫°n c·∫Øt tay, d√πng m√°u ƒë·ªÉ d·ª• sinh v·∫≠t t√†ng h√¨nh. N√≥ hi·ªán h√¨nh, v√† b·∫°n ch√©m n√≥ b·∫±ng dao ph·∫´u thu·∫≠t. B·∫°n thu ƒë∆∞·ª£c m·∫´u da, nh∆∞ng v·∫øt th∆∞∆°ng l√†m b·∫°n y·∫øu ƒëi. 'M√¨nh kh√¥ng th·ªÉ ti·∫øp t·ª•c th·∫ø n√†y,' b·∫°n r√™n r·ªâ.",
                effects: { data: 15, inventory: { sample: 1 }, health: -20, morale: 10 },
                choices: [
                    { text: "Quay l·∫°i cƒÉn c·ª©", next: "lab_entry", effects: { morale: -10, danger: 20 } },
                    { text: "T√¨m b·ªô ph√°t t√≠n hi·ªáu", next: "find_signal", effects: { morale: -10, danger: 40 } },
                    { text: "Ngh·ªâ ng∆°i", next: "rest_forest", effects: { morale: 10, health: 10 } }
                ]
            },
            escape_invisible: {
                text: "B·∫°n ch·∫°y tho√°t, nh∆∞ng sinh v·∫≠t t√†ng h√¨nh ƒëu·ªïi theo. B·∫°n v·∫•p ng√£, b·ªã n√≥ c√†o r√°ch l∆∞ng. B·∫°n tr·ªën ƒë∆∞·ª£c, nh∆∞ng c∆° th·ªÉ ƒëau ƒë·ªõn v√† tinh th·∫ßn suy s·ª•p. 'M√¨nh c·∫ßn ngh·ªâ... nh∆∞ng kh√¥ng an to√†n,' b·∫°n nghƒ©.",
                effects: { health: -30, morale: -20 },
                choices: [
                    { text: "Quay l·∫°i cƒÉn c·ª©", next: "lab_entry", effects: { morale: -10, danger: 20 } },
                    { text: "T√¨m b·ªô ph√°t t√≠n hi·ªáu", next: "find_signal", effects: { morale: -10, danger: 40 } },
                    { text: "Ngh·ªâ ng∆°i", next: "rest_forest", effects: { morale: 10, health: 10 } }
                ]
            },
            shoot_invisible: {
                text: () => {
                    if (inventory.tranquilizer > 0) {
                        return {
                            text: "B·∫°n b·∫Øn s√∫ng g√¢y m√™, l√†m sinh v·∫≠t t√†ng h√¨nh ng√£ xu·ªëng. B·∫°n l·∫•y m·∫´u da c·ªßa n√≥, c·∫£m th·∫•y t·ª± tin h∆°n. 'M·ªôt b∆∞·ªõc g·∫ßn h∆°n ƒë·∫øn s·ª± th·∫≠t,' b·∫°n nghƒ©.",
                            effects: { data: 15, inventory: { sample: 1 }, morale: 15 },
                            choices: [
                                { text: "Quay l·∫°i cƒÉn c·ª©", next: "lab_entry", effects: { morale: -10, danger: 20 } },
                                { text: "T√¨m b·ªô ph√°t t√≠n hi·ªáu", next: "find_signal", effects: { morale: -10, danger: 40 } },
                                { text: "Ngh·ªâ ng∆°i", next: "rest_forest", effects: { morale: 10, health: 10 } }
                            ]
                        };
                    } else {
                        return {
                            text: "S√∫ng h·∫øt ƒë·∫°n! Sinh v·∫≠t t√†ng h√¨nh lao t·ªõi, m√≥ng vu·ªët x√© to·∫°c b·∫°n. B·∫°n ng√£ xu·ªëng, m√°u loang tr√™n ƒë·∫•t.",
                            ending: "Bad Ending: B·ªã sinh v·∫≠t t√†ng h√¨nh gi·∫øt, nhi·ªám v·ª• th·∫•t b·∫°i."
                        };
                    }
                }
            },
            find_signal: {
                text: "B·∫°n leo l√™n ƒë·ªânh ƒë·ªìi, t√¨m th·∫•y m·ªôt b·ªô ph√°t t√≠n hi·ªáu c≈©. Nh∆∞ng th·ª±c v·∫≠t di chuy·ªÉn m·ªçc k√≠n khu v·ª±c, r·ªÖ x√∫c tu qu·∫•n quanh thi·∫øt b·ªã. B·∫°n th√¨ th·∫ßm: 'M√¨nh c·∫ßn v√¥ hi·ªáu h√≥a ch√∫ng tr∆∞·ªõc.'",
                choices: [
                    { text: "D√πng b√¨nh x·ªãt h√≥a h·ªçc", next: "use_chemical_signal", effects: { inventory: { chemical: -1 }, morale: -10 } },
                    { text: "C·∫Øt r·ªÖ b·∫±ng dao", next: "cut_signal", effects: { health: -20, morale: -15 } },
                    { text: "B·ªè qua v√† quay l·∫°i", next: "lab_entry", effects: { morale: -10, danger: 20 } }
                ]
            },
            use_chemical_signal: {
                text: () => {
                    if (inventory.chemical > 0) {
                        return {
                            text: "B·∫°n x·ªãt h√≥a ch·∫•t, l√†m th·ª±c v·∫≠t co r√∫m l·∫°i. B·ªô ph√°t t√≠n hi·ªáu ho·∫°t ƒë·ªông, g·ª≠i t√≠n hi·ªáu c·ª©u h·ªô. 'Gi·ªù ch·ªâ c·∫ßn ch·ªù... ho·∫∑c ti·∫øp t·ª•c ƒëi·ªÅu tra,' b·∫°n nghƒ©.",
                            effects: { inventory: { signal: 1 }, morale: 20 },
                            choices: [
                                { text: "Ch·ªù c·ª©u h·ªô", next: "wait_rescue", effects: { morale: 10, danger: 20 } },
                                { text: "Quay l·∫°i ph√≤ng th√≠ nghi·ªám", next: "dna_storage", effects: { morale: -10, danger: 40 } },
                                { text: "ƒê·ªëi ƒë·∫ßu X13", next: "confront_alpha", effects: { morale: -20, danger: 50 } }
                            ]
                        };
                    } else {
                        return {
                            text: "B·∫°n kh√¥ng c√≥ b√¨nh x·ªãt! Th·ª±c v·∫≠t qu·∫•n l·∫•y b·∫°n, enzyme ph√¢n gi·∫£i c∆° th·ªÉ b·∫°n trong ƒëau ƒë·ªõn.",
                            ending: "Bad Ending: B·ªã th·ª±c v·∫≠t di chuy·ªÉn ti√™u di·ªát."
                        };
                    }
                }
            },
            cut_signal: {
                text: "B·∫°n d√πng dao c·∫Øt r·ªÖ, nh∆∞ng enzyme phun v√†o m·∫∑t b·∫°n. B·∫°n k√≠ch ho·∫°t ƒë∆∞·ª£c b·ªô ph√°t t√≠n hi·ªáu, nh∆∞ng c∆° th·ªÉ y·∫øu ƒëi nhanh ch√≥ng. 'M√¨nh... ph·∫£i c·∫ßm c·ª±,' b·∫°n r√™n r·ªâ.",
                effects: { inventory: { signal: 1 }, health: -30, morale: -20 },
                choices: [
                    { text: "Ch·ªù c·ª©u h·ªô", next: "wait_rescue", effects: { morale: 10, danger: 20 } },
                    { text: "Quay l·∫°i ph√≤ng th√≠ nghi·ªám", next: "dna_storage", effects: { morale: -10, danger: 40 } },
                    { text: "Ngh·ªâ ng∆°i", next: "rest_forest", effects: { morale: 10, health: 10 } }
                ]
            },
            wait_rescue: {
                text: () => {
                    if (stats.data >= 50) {
                        return {
                            text: "Tr·ª±c thƒÉng c·ª©u h·ªô ƒë·∫øn, b·∫°n mang theo ·ªï c·ª©ng ƒë·∫ßy d·ªØ li·ªáu. Th·∫ø gi·ªõi s·∫Ω bi·∫øt s·ª± th·∫≠t v·ªÅ X13, v√† b·∫°n ti√™u di·ªát ƒë∆∞·ª£c Alpha tr∆∞·ªõc khi r·ªùi ƒëi.",
                            ending: "Happy Ending: Mang d·ªØ li·ªáu v·ªÅ, ti√™u di·ªát X13, c·ª©u th·∫ø gi·ªõi."
                        };
                    } else {
                        return {
                            text: "Tr·ª±c thƒÉng c·ª©u h·ªô ƒë·∫øn, nh∆∞ng b·∫°n kh√¥ng mang ƒë·ªß d·ªØ li·ªáu. T·ªï ch·ª©c b√≠ m·∫≠t b·∫Øt b·∫°n quay l·∫°i ƒë·∫£o ƒë·ªÉ ti·∫øp t·ª•c nhi·ªám v·ª•.",
                            ending: "V√≤ng L·∫∑p Ending: B·ªã ƒë∆∞a l·∫°i ƒë·∫£o v√¨ d·ªØ li·ªáu kh√¥ng ƒë·ªß."
                        };
                    }
                }
            },
            dna_storage: {
                text: "B·∫°n ƒë·∫øn khu l∆∞u tr·ªØ DNA, m√°y t√≠nh ch√≠nh v·∫´n ho·∫°t ƒë·ªông, nh∆∞ng c·∫ßn pin d·ª± ph√≤ng ƒë·ªÉ t·∫£i d·ªØ li·ªáu. M·ªôt b√≥ng ng∆∞·ªùi xu·∫•t hi·ªán ·ªü g√≥c ph√≤ng ‚Äì X13, m·∫Øt ph√°t s√°ng, g·∫ßm g·ª´: 'Ng∆∞∆°i nghƒ© ng∆∞∆°i hi·ªÉu ch√∫ng ta? Ng∆∞∆°i ch·ªâ l√† con m·ªìi!' B·∫°n ph·∫£i h√†nh ƒë·ªông nhanh.",
                timeLimit: 30,
                choices: [
                    { text: "Thuy·∫øt ph·ª•c X13", next: "persuade_alpha", effects: { morale: -10, danger: 40 } },
                    { text: "ƒê·ªëi ƒë·∫ßu X13", next: "confront_alpha", effects: { morale: -20, danger: 50 } },
                    { text: "Tr·ªën xu·ªëng t·∫ßng h·∫ßm", next: "basement", effects: { morale: -5, danger: 40 } }
                ]
            },
            persuade_alpha: {
                text: "B·∫°n n√≥i v·ªõi X13: 'T√¥i kh√¥ng mu·ªën h·∫°i anh... h√£y ƒë·ªÉ t√¥i l·∫•y d·ªØ li·ªáu v√† r·ªùi ƒëi.' N√≥ nghi√™ng ƒë·∫ßu, m·∫Øt s√°ng r·ª±c: 'Ng∆∞∆°i s·∫Ω ph·∫£n b·ªôi, nh∆∞ h·ªç.' N√≥ ƒë·ªìng √Ω th·∫£ b·∫°n, nh∆∞ng b·∫°n c·∫£m th·∫•y n√≥ v·∫´n theo d√µi.",
                effects: { morale: 10, danger: 30 },
                choices: [
                    { text: "T√¨m pin d·ª± ph√≤ng ·ªü t·∫ßng h·∫ßm", next: "basement", effects: { morale: -10, danger: 40 } },
                    { text: "T·∫£i d·ªØ li·ªáu ngay", next: "download_data", effects: { morale: -10, danger: 30 } },
                    { text: "T√¨m ƒë∆∞·ªùng tho√°t ƒë·∫£o", next: "escape_island", effects: { morale: -5, danger: 30 } }
                ]
            },
            confront_alpha: {
                text: () => {
                    if (inventory.tranquilizer > 0) {
                        return {
                            text: "B·∫°n b·∫Øn s√∫ng g√¢y m√™, l√†m X13 ng√£ xu·ªëng. B·∫°n l·∫•y m·∫´u m√°u c·ªßa n√≥, nh∆∞ng n√≥ g·∫ßm l√™n: 'Ng∆∞∆°i s·∫Ω h·ªëi ti·∫øc!' B·∫°n ch·∫°y tho√°t, nh∆∞ng c∆° th·ªÉ m·ªát m·ªèi.",
                            effects: { data: 20, inventory: { sample: 1 }, health: -20, morale: 10 },
                            choices: [
                                { text: "T√¨m pin d·ª± ph√≤ng ·ªü t·∫ßng h·∫ßm", next: "basement", effects: { morale: -10, danger: 40 } },
                                { text: "T·∫£i d·ªØ li·ªáu ngay", next: "download_data", effects: { morale: -10, danger: 30 } },
                                { text: "T√¨m ƒë∆∞·ªùng tho√°t ƒë·∫£o", next: "escape_island", effects: { morale: -5, danger: 30 } }
                            ]
                        };
                    } else {
                        return {
                            text: "B·∫°n ƒë·ªëi ƒë·∫ßu X13 b·∫±ng dao, nh∆∞ng n√≥ qu√° m·∫°nh. M·ªôt c√∫ ƒë·∫•m c·ªßa n√≥ khi·∫øn b·∫°n ng√£, v√† m√≥ng vu·ªët x√© to·∫°c b·∫°n. M·ªçi th·ª© ch√¨m v√†o b√≥ng t·ªëi.",
                            ending: "Bad Ending: B·ªã X13 ti√™u di·ªát, nhi·ªám v·ª• th·∫•t b·∫°i."
                        };
                    }
                }
            },
            basement: {
                text: "T·∫ßng h·∫ßm t·ªëi om, m√πi t·ª≠ kh√≠ n·ªìng n·∫∑c. B·∫°n t√¨m th·∫•y pin d·ª± ph√≤ng, nh∆∞ng m·ªôt sinh v·∫≠t t√†ng h√¨nh hi·ªán ra khi m√°u t·ª´ v·∫øt x∆∞·ªõc c·ªßa b·∫°n d√≠nh v√†o n√≥. 'N√≥ ·ªü ngay ƒë√¢y!' b·∫°n h√©t th·∫ßm, tay n·∫Øm ch·∫∑t ƒë√®n pin.",
                effects: { inventory: { battery: 1 }, morale: -15, danger: 50 },
                choices: [
                    { text: "D√πng m√°u ƒë·ªÉ d·ª• n√≥", next: "bait_invisible_basement", effects: { health: -15, morale: -10 } },
                    { text: "D√πng s√∫ng g√¢y m√™", next: "shoot_invisible_basement", effects: { inventory: { tranquilizer: -1 }, morale: -15 } },
                    { text: "Ch·∫°y tho√°t", next: "escape_basement", effects: { morale: -10, health: -10 } }
                ]
            },
            bait_invisible_basement: {
                text: "B·∫°n c·∫Øt tay, d·ª• sinh v·∫≠t t√†ng h√¨nh hi·ªán h√¨nh. B·∫°n b·∫Øn n√≥ b·∫±ng s√∫ng g√¢y m√™, l·∫•y m·∫´u da. Nh∆∞ng v·∫øt th∆∞∆°ng l√†m b·∫°n y·∫øu ƒëi. 'M√¨nh c·∫ßn t·∫£i d·ªØ li·ªáu v√† r·ªùi kh·ªèi ƒë√¢y,' b·∫°n nghƒ©.",
                effects: { data: 15, inventory: { sample: 1 }, health: -20, morale: 10 },
                choices: [
                    { text: "T·∫£i d·ªØ li·ªáu ·ªü khu l∆∞u tr·ªØ", next: "download_data", effects: { morale: -10, danger: 30 } },
                    { text: "T√¨m ƒë∆∞·ªùng tho√°t ƒë·∫£o", next: "escape_island", effects: { morale: -5, danger: 30 } },
                    { text: "Ngh·ªâ ng∆°i", next: "rest_lab", effects: { morale: 10, health: 10 } }
                ]
            },
            shoot_invisible_basement: {
                text: () => {
                    if (inventory.tranquilizer > 0) {
                        return {
                            text: "B·∫°n b·∫Øn s√∫ng g√¢y m√™, l√†m sinh v·∫≠t t√†ng h√¨nh ng√£. B·∫°n l·∫•y m·∫´u da, c·∫£m th·∫•y t·ª± tin h∆°n. 'C√≤n m·ªôt b∆∞·ªõc n·ªØa th√¥i,' b·∫°n nghƒ©.",
                            effects: { data: 15, inventory: { sample: 1 }, morale: 15 },
                            choices: [
                                { text: "T·∫£i d·ªØ li·ªáu ·ªü khu l∆∞u tr·ªØ", next: "download_data", effects: { morale: -10, danger: 30 } },
                                { text: "T√¨m ƒë∆∞·ªùng tho√°t ƒë·∫£o", next: "escape_island", effects: { morale: -5, danger: 30 } },
                                { text: "Ngh·ªâ ng∆°i", next: "rest_lab", effects: { morale: 10, health: 10 } }
                            ]
                        };
                    } else {
                        return {
                            text: "S√∫ng h·∫øt ƒë·∫°n! Sinh v·∫≠t t√†ng h√¨nh x√© to·∫°c b·∫°n, m√°u loang tr√™n s√†n t·∫ßng h·∫ßm.",
                            ending: "Bad Ending: B·ªã sinh v·∫≠t t√†ng h√¨nh gi·∫øt trong t·∫ßng h·∫ßm."
                        };
                    }
                }
            },
            escape_basement: {
                text: "B·∫°n ch·∫°y tho√°t t·∫ßng h·∫ßm, nh∆∞ng sinh v·∫≠t t√†ng h√¨nh c√†o r√°ch l∆∞ng b·∫°n. B·∫°n l√™ b∆∞·ªõc v·ªÅ khu l∆∞u tr·ªØ, nh∆∞ng tinh th·∫ßn suy s·ª•p. 'M√¨nh kh√¥ng th·ªÉ ti·∫øp t·ª•c th·∫ø n√†y,' b·∫°n r√™n r·ªâ.",
                effects: { health: -30, morale: -20 },
                choices: [
                    { text: "T·∫£i d·ªØ li·ªáu ·ªü khu l∆∞u tr·ªØ", next: "download_data", effects: { morale: -10, danger: 30 } },
                    { text: "T√¨m ƒë∆∞·ªùng tho√°t ƒë·∫£o", next: "escape_island", effects: { morale: -5, danger: 30 } },
                    { text: "Ngh·ªâ ng∆°i", next: "rest_lab", effects: { morale: 10, health: 10 } }
                ]
            },
            download_data: {
                text: () => {
                    if (inventory.battery > 0) {
                        return {
                            text: "B·∫°n c·∫Øm pin d·ª± ph√≤ng, m√°y t√≠nh kh·ªüi ƒë·ªông. D·ªØ li·ªáu DNA c·ªßa X13 v√† c√°c sinh v·∫≠t kh√°c ƒë∆∞·ª£c t·∫£i v√†o ·ªï c·ª©ng. 'ƒê√¢y l√† ch√¨a kh√≥a ƒë·ªÉ hi·ªÉu m·ªçi th·ª©,' b·∫°n nghƒ©. Nh∆∞ng X13 xu·∫•t hi·ªán l·∫°i, g·∫ßm g·ª´: 'Ng∆∞∆°i kh√¥ng ƒë∆∞·ª£c r·ªùi ƒëi!'",
                            effects: { data: 30, inventory: { drive: 1 }, morale: -10, danger: 50 },
                            choices: [
                                { text: "ƒê·ªëi ƒë·∫ßu X13", next: "confront_alpha_final", effects: { morale: -20, danger: 50 } },
                                { text: "T√¨m ƒë∆∞·ªùng tho√°t ƒë·∫£o", next: "escape_island", effects: { morale: -5, danger: 30 } },
                                { text: "ƒê·ªët tr·ª• s·ªü nghi√™n c·ª©u", next: "burn_base", effects: { morale: -10, danger: 40 } }
                            ]
                        };
                    } else {
                        return {
                            text: "Kh√¥ng c√≥ pin d·ª± ph√≤ng, m√°y t√≠nh kh√¥ng ho·∫°t ƒë·ªông. X13 xu·∫•t hi·ªán, ƒë·∫≠p v·ª° m√°y t√≠nh v√† x√© to·∫°c b·∫°n. M·ªçi th·ª© ch√¨m v√†o b√≥ng t·ªëi.",
                            ending: "Bad Ending: Th·∫•t b·∫°i trong vi·ªác t·∫£i d·ªØ li·ªáu, b·ªã X13 gi·∫øt."
                        };
                    }
                }
            },
            confront_alpha_final: {
                text: () => {
                    if (inventory.tranquilizer > 0 || inventory.chemical > 0) {
                        return {
                            text: "B·∫°n d√πng s√∫ng g√¢y m√™ v√† b√¨nh x·ªãt h√≥a h·ªçc ƒë·ªÉ h·∫° X13. N√≥ ng√£ xu·ªëng, m√°u ch·∫£y ra t·ª´ m·∫Øt. B·∫°n l·∫•y m·∫´u cu·ªëi c√πng, c·∫£m th·∫•y nhi·ªám v·ª• ho√†n th√†nh. 'M√¨nh ph·∫£i r·ªùi kh·ªèi ƒë√¢y,' b·∫°n nghƒ©.",
                            effects: { data: 20, inventory: { sample: 1 }, health: -20, morale: 20 },
                            choices: [
                                { text: "T√¨m ƒë∆∞·ªùng tho√°t ƒë·∫£o", next: "escape_island", effects: { morale: -5, danger: 30 } },
                                { text: "ƒê·ªët tr·ª• s·ªü nghi√™n c·ª©u", next: "burn_base", effects: { morale: -10, danger: 40 } },
                                { text: "T√¨m nh·∫≠t k√Ω ·∫©n", next: "find_secret_journal", effects: { morale: -10, data: 15 } }
                            ]
                        };
                    } else {
                        return {
                            text: "B·∫°n kh√¥ng ƒë·ªß v≈© kh√≠ ƒë·ªÉ h·∫° X13. N√≥ lao t·ªõi, m√≥ng vu·ªët x√© to·∫°c b·∫°n. M·ªçi hy v·ªçng tan bi·∫øn.",
                            ending: "Bad Ending: B·ªã X13 ti√™u di·ªát, nhi·ªám v·ª• th·∫•t b·∫°i."
                        };
                    }
                }
            },
            find_secret_journal: {
                text: "B·∫°n t√¨m th·∫•y nh·∫≠t k√Ω ·∫©n c·ªßa nh√† khoa h·ªçc tr∆∞·ªüng trong k√©t s·∫Øt. N√≥ vi·∫øt: 'T·ªï ch·ª©c ƒë·ª©ng sau X13 s·∫Ω kh√¥ng d·ª´ng l·∫°i. H·ªßy h√≤n ƒë·∫£o n√†y, ho·∫∑c nh√¢n lo·∫°i s·∫Ω di·ªát vong.' B·∫°n c·∫£m th·∫•y tr·ªçng tr√°ch l·ªõn lao, nh∆∞ng c∆° th·ªÉ ki·ªát s·ª©c.",
                effects: { data: 20, morale: 10 },
                choices: [
                    { text: "ƒê·ªët tr·ª• s·ªü nghi√™n c·ª©u", next: "burn_base", effects: { morale: -10, danger: 40 } },
                    { text: "T√¨m ƒë∆∞·ªùng tho√°t ƒë·∫£o", next: "escape_island", effects: { morale: -5, danger: 30 } },
                    { text: "Ch·∫ø vaccine", next: "make_vaccine", effects: { morale: 20, data: 15 } }
                ]
            },
            burn_base: {
                text: "B·∫°n ƒë·ªï h√≥a ch·∫•t kh·∫Øp cƒÉn c·ª© v√† ch√¢m l·ª≠a. Ng·ªçn l·ª≠a nu·ªët ch·ª≠ng m·ªçi th·ª© ‚Äì d·ªØ li·ªáu, sinh v·∫≠t, v√† b√≠ m·∫≠t c·ªßa X13. B·∫°n tho√°t ra b·∫±ng thuy·ªÅn nh·ªè, nh√¨n h√≤n ƒë·∫£o ch√°y r·ª•i. Kh√¥ng ai bi·∫øt s·ª± th·∫≠t, nh∆∞ng b·∫°n ƒë√£ x√≥a s·∫°ch m·ªëi ƒëe d·ªça.",
                ending: "X√≥a S·∫°ch Ending: H√≤n ƒë·∫£o b·ªã thi√™u r·ª•i, b√≠ m·∫≠t ch√¥n v√πi m√£i m√£i."
            },
            escape_island: {
                text: () => {
                    if (stats.data >= 50 && inventory.vaccine) {
                        return {
                            text: "B·∫°n r·ªùi ƒë·∫£o b·∫±ng thuy·ªÅn nh·ªè, mang theo ·ªï c·ª©ng v√† vaccine. Th·∫ø gi·ªõi ƒë∆∞·ª£c c·ª©u nh·ªù vaccine, nh∆∞ng b·∫°n kh√¥ng ƒë∆∞·ª£c c√¥ng nh·∫≠n. 'M√¨nh ƒë√£ l√†m ƒëi·ªÅu ƒë√∫ng ƒë·∫Øn,' b·∫°n nghƒ©.",
                            ending: "Anh H√πng Ending: Ph√°t tri·ªÉn vaccine, c·ª©u nh√¢n lo·∫°i v√¥ danh."
                        };
                    } else if (stats.data >= 50) {
                        return {
                            text: "B·∫°n r·ªùi ƒë·∫£o v·ªõi ·ªï c·ª©ng ƒë·∫ßy d·ªØ li·ªáu. C√°c nh√† khoa h·ªçc s·ª≠ng s·ªët tr∆∞·ªõc ph√°t hi·ªán v·ªÅ X13. B·∫°n tr·ªü th√†nh ng∆∞·ªùi h√πng, nh∆∞ng k√Ω ·ª©c v·ªÅ ƒë·∫£o v·∫´n √°m ·∫£nh.",
                            ending: "Happy Ending: Mang d·ªØ li·ªáu v·ªÅ, gi·∫£i m√£ b√≠ m·∫≠t X13."
                        };
                    } else if (inventory.signal) {
                        return {
                            text: "B·∫°n r·ªùi ƒë·∫£o b·∫±ng thuy·ªÅn nh·ªè, nh∆∞ng kh√¥ng mang ƒë·ªß d·ªØ li·ªáu. T√¢m tr√≠ b·∫°n ho·∫£ng lo·∫°n, √°m ·∫£nh b·ªüi nh·ªØng sinh v·∫≠t. 'M√¨nh s·ªëng s√≥t... nh∆∞ng ƒë·ªÉ l√†m g√¨?'",
                            ending: "S·ªëng S√≥t Ending: Tho√°t ƒë·∫£o, nh∆∞ng t√¢m tr√≠ tan v·ª°."
                        };
                    } else {
                        return {
                            text: "B·∫°n c·ªë r·ªùi ƒë·∫£o, nh∆∞ng k√Ω sinh b√°m v√†o thuy·ªÅn. Ch√∫ng chi·∫øm c∆° th·ªÉ b·∫°n, v√† b·∫°n tr·ªü th√†nh m·ªôt trong s·ªë ch√∫ng.",
                            ending: "Bi·∫øn D·ªã Ending: B·ªã nhi·ªÖm, b·∫°n tr·ªü th√†nh qu√°i v·∫≠t."
                        };
                    }
                }
            },
            rest_forest: {
                text: "B·∫°n ngh·ªâ ng∆°i trong r·ª´ng, c·ªë l·∫•y l·∫°i b√¨nh tƒ©nh. Nh∆∞ng ti·∫øng r√≠t c·ªßa sinh v·∫≠t khi·∫øn b·∫°n kh√¥ng th·ªÉ th∆∞ gi√£n ho√†n to√†n. 'M√¨nh c·∫ßn ti·∫øp t·ª•c... kh√¥ng th·ªÉ d·ª´ng l·∫°i,' b·∫°n t·ª± nh·ªß.",
                effects: { morale: 10, health: 10 },
                choices: [
                    { text: "Quay l·∫°i cƒÉn c·ª©", next: "lab_entry", effects: { morale: -10, danger: 20 } },
                    { text: "T√¨m b·ªô ph√°t t√≠n hi·ªáu", next: "find_signal", effects: { morale: -10, danger: 40 } },
                    { text: "Kh√°m ph√° s√¢u h∆°n trong r·ª´ng", next: "deep_forest", effects: { morale: -10, danger: 40 } }
                ]
            },
            rest_lab: {
                text: "B·∫°n ngh·ªâ trong ph√≤ng th√≠ nghi·ªám, d√πng b·ªô s∆° c·ª©u ƒë·ªÉ h·ªìi ph·ª•c. Tinh th·∫ßn b·∫°n ·ªïn ƒë·ªãnh h∆°n, nh∆∞ng ti·∫øng g·∫ßm t·ª´ xa nh·∫Øc nh·ªü b·∫°n v·ªÅ nguy hi·ªÉm. 'M√¨nh ph·∫£i nhanh l√™n,' b·∫°n nghƒ©.",
                effects: { morale: 10, health: 20 },
                choices: [
                    { text: "T·∫£i d·ªØ li·ªáu ·ªü khu l∆∞u tr·ªØ", next: "download_data", effects: { morale: -10, danger: 30 } },
                    { text: "T√¨m ƒë∆∞·ªùng tho√°t ƒë·∫£o", next: "escape_island", effects: { morale: -5, danger: 30 } },
                    { text: "T√¨m b√¨nh x·ªãt h√≥a h·ªçc", next: "find_chemical", effects: { morale: -10, danger: 30 } }
                ]
            }
        };

        let currentNode = "start";
        let timeLeft = 0;
        let timerInterval = null;

        function updateStats(effects) {
            if (effects) {
                stats.morale = Math.max(0, Math.min(100, stats.morale + (effects.morale || 0)));
                stats.health = Math.max(0, Math.min(100, stats.health + (effects.health || 0)));
                stats.data = Math.max(0, stats.data + (effects.data || 0));
                stats.danger = Math.max(10, Math.min(100, stats.danger + (effects.danger || 0)));
                if (effects.inventory) {
                    for (let key in effects.inventory) {
                        inventory[key] = (inventory[key] || 0) + effects.inventory[key];
                        if (inventory[key] < 0) inventory[key] = 0;
                    }
                    if (effects.inventory.tools) {
                        inventory.tools.push(...effects.inventory.tools);
                    }
                }
            }

            document.getElementById("morale").innerText = stats.morale;
            document.getElementById("health").innerText = stats.health;
            document.getElementById("data").innerText = stats.data;
            document.getElementById("danger").innerText = stats.danger;

            let inventoryText = "T√†i nguy√™n: ";
            for (let key in inventory) {
                if (key !== "tools" && inventory[key] > 0) {
                    inventoryText += `${key}: ${inventory[key]}, `;
                }
            }
            inventoryText += `C√¥ng c·ª•: ${inventory.tools.join(", ")}`;
            document.getElementById("inventory").innerText = inventoryText;

            if (stats.health <= 0) {
                currentNode = "bad_ending";
                displayCurrentNode();
            } else if (stats.morale <= 0) {
                currentNode = "loop_ending";
                displayCurrentNode();
            }
        }

        function startTimer(limit) {
            if (timerInterval) clearInterval(timerInterval);
            timeLeft = limit;
            const timerElement = document.getElementById("timer");
            timerElement.innerText = `Th·ªùi gian c√≤n l·∫°i: ${timeLeft} gi√¢y`;
            timerInterval = setInterval(() => {
                timeLeft--;
                timerElement.innerText = `Th·ªùi gian c√≤n l·∫°i: ${timeLeft} gi√¢y`;
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    currentNode = "time_out";
                    displayCurrentNode();
                }
            }, 1000);
        }

        function displayCurrentNode() {
            let node = storyNodes[currentNode] || {
                text: "B·∫°n ki·ªát s·ª©c, ng√£ xu·ªëng s√†n ph√≤ng th√≠ nghi·ªám. Sinh v·∫≠t bao v√¢y, v√† b√≥ng t·ªëi nu·ªët ch·ª≠ng b·∫°n.",
                ending: "Bad Ending: Ch·∫øt trong tay qu√°i v·∫≠t, nhi·ªám v·ª• th·∫•t b·∫°i."
            };

            if (typeof node.text === "function") {
                node = node.text();
            }

            document.getElementById("story-text").innerHTML = node.text.replace(/\n/g, "<br>");
            const choicesContainer = document.getElementById("choices");
            const endingContainer = document.getElementById("ending");
            choicesContainer.innerHTML = "";
            endingContainer.innerText = "";

            if (node.timeLimit) {
                startTimer(node.timeLimit);
            } else {
                clearInterval(timerInterval);
                document.getElementById("timer").innerText = "";
            }

            if (node.effects) {
                updateStats(node.effects);
            }

            if (node.choices) {
                node.choices.forEach(choice => {
                    const button = document.createElement("button");
                    button.innerText = choice.text;
                    button.className = "choice-btn";
                    button.onclick = () => {
                        clearInterval(timerInterval);
                        currentNode = choice.next;
                        updateStats(choice.effects);
                        displayCurrentNode();
                    };
                    choicesContainer.appendChild(button);
                });
            } else {
                clearInterval(timerInterval);
                endingContainer.innerText = node.ending;
                const restartButton = document.createElement("button");
                restartButton.innerText = "Ch∆°i l·∫°i t·ª´ ƒë·∫ßu";
                restartButton.className = "choice-btn restart-btn";
                restartButton.onclick = () => {
                    stats = { morale: 100, health: 100, data: 0, danger: 10 };
                    inventory = {
                        tranquilizer: 3, knife: 1, flashlight: 1, medkit: 0, battery: 0,
                        chemical: 0, sample: 0, drive: 0, signal: 0,
                        tools: ["S√∫ng g√¢y m√™ (3 ƒë·∫°n)", "Dao ph·∫´u thu·∫≠t", "ƒê√®n pin"]
                    };
                    currentNode = "start";
                    updateStats();
                    displayCurrentNode();
                };
                choicesContainer.appendChild(restartButton);
            }
        }

        window.onload = () => {
            displayCurrentNode();
        };
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S·ªëng S√≥t Tr√™n H√≤n ƒê·∫£o Hoang</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f0e4d7;
            color: #333;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .container {
            max-width: 900px;
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
        }
        h1 {
            text-align: center;
            color: #228B22;
            text-shadow: 0 0 5px #90EE90;
        }
        .stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            background-color: #e0f0e0;
            padding: 10px;
            border-radius: 5px;
        }
        .stat {
            font-weight: bold;
        }
        .story-text {
            line-height: 1.6;
            margin-bottom: 20px;
            font-size: 1.1em;
        }
        .dialogue {
            background-color: #f0f8f0;
            padding: 10px;
            border-left: 4px solid #228B22;
            margin: 10px 0;
        }
        .inventory {
            background-color: #f0f8f0;
            padding: 10px;
            margin-bottom: 20px;
            border-radius: 5px;
        }
        .choices {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .choice-btn {
            background-color: #228B22;
            color: #fff;
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s;
        }
        .choice-btn:hover {
            background-color: #1a6b1a;
        }
        .ending {
            font-weight: bold;
            color: #ff4500;
            margin-top: 20px;
            text-align: center;
        }
        .restart-btn {
            background-color: #4682b4;
            margin-top: 10px;
        }
        .restart-btn:hover {
            background-color: #36648b;
        }
        .timer {
            color: #ff4500;
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üèùÔ∏è S·ªëng S√≥t Tr√™n H√≤n ƒê·∫£o Hoang</h1>
        <div id="stats" class="stats">
            <span class="stat">Th·ªÉ l·ª±c: <span id="health">100</span>%</span>
            <span class="stat">ƒê√≥i: <span id="hunger">100</span>%</span>
            <span class="stat">Kh√°t: <span id="thirst">100</span>%</span>
            <span class="stat">Tinh th·∫ßn: <span id="morale">100</span>%</span>
        </div>
        <div id="inventory" class="inventory">T√†i nguy√™n: Ba l√¥ (Dao nh·ªè, ƒê√°nh l·ª≠a, 2m d√¢y th·ª´ng)</div>
        <div id="timer" class="timer"></div>
        <div id="story-text" class="story-text"></div>
        <div id="choices" class="choices"></div>
        <div id="ending" class="ending"></div>
    </div>

    <script>
        let stats = {
            health: 100,
            hunger: 100,
            thirst: 100,
            morale: 100
        };

        let inventory = {
            wood: 0,
            stone: 0,
            vine: 0,
            leaf: 0,
            fish: 0,
            fruit: 0,
            water: 0,
            shell: 0,
            tools: ["Dao nh·ªè", "ƒê√°nh l·ª≠a", "2m d√¢y th·ª´ng"]
        };

        let experience = 0; // Kinh nghi·ªám gi·ªØ l·∫°i n·∫øu Loop Ending

        const storyNodes = {
            start: {
                text: "B·∫°n t·ªânh d·∫≠y tr√™n b√£i bi·ªÉn, c√°t n√≥ng b·ªèng d∆∞·ªõi l∆∞ng. Ti·∫øng s√≥ng v·ªó ƒë·ªÅu ƒë·ªÅu, nh∆∞ng k√Ω ·ª©c v·ªÅ v·ª• ƒë·∫Øm t√†u v·∫´n m∆° h·ªì. Ba l√¥ nh·ªè b√™n c·∫°nh ch·ª©a m·ªôt con dao nh·ªè, b·ªô ƒë√°nh l·ª≠a, v√† 2m d√¢y th·ª´ng. ƒê·∫ßu b·∫°n ƒëau nh·ª©c, nh∆∞ng b·∫°n t·ª± nh·ªß: 'M√¨nh ph·∫£i s·ªëng s√≥t... ph·∫£i t√¨m c√°ch r·ªùi kh·ªèi ƒë√¢y!' M·∫∑t tr·ªùi ƒëang l√™n cao, v√† b·∫°n c·∫£m th·∫•y kh√°t ch√°y c·ªï. B·∫°n quy·∫øt ƒë·ªãnh h√†nh ƒë·ªông.",
                timeLimit: 60,
                choices: [
                    { text: "Kh√°m ph√° khu r·ª´ng", next: "explore_forest", effects: { thirst: -10, hunger: -5 } },
                    { text: "L·∫≠p tr·∫°i g·∫ßn b·ªù bi·ªÉn", next: "camp_beach", effects: { morale: 10, thirst: -10 } },
                    { text: "Ki·ªÉm tra ba l√¥ v√† ngh·ªâ ng∆°i", next: "check_backpack", effects: { health: 10, morale: 5 } }
                ]
            },
            check_backpack: {
                text: "B·∫°n ki·ªÉm tra ba l√¥: m·ªôt con dao nh·ªè, b·ªô ƒë√°nh l·ª≠a, v√† √≠t d√¢y th·ª´ng. B·∫°n ng·ªìi ngh·ªâ d∆∞·ªõi b√≥ng c√¢y, c·∫£m th·∫•y c∆° th·ªÉ h·ªìi ph·ª•c ƒë√¥i ch√∫t. Tuy nhi√™n, c√°i kh√°t v√† ƒë√≥i b·∫Øt ƒë·∫ßu r√µ r·ªát h∆°n. B·∫°n t·ª± nh·ªß: 'Kh√¥ng th·ªÉ ng·ªìi ƒë√¢y m√£i, ph·∫£i h√†nh ƒë·ªông!'",
                choices: [
                    { text: "Kh√°m ph√° khu r·ª´ng", next: "explore_forest", effects: { thirst: -10, hunger: -5 } },
                    { text: "L·∫≠p tr·∫°i g·∫ßn b·ªù bi·ªÉn", next: "camp_beach", effects: { morale: 10, thirst: -10 } },
                    { text: "T√¨m th·ª©c ƒÉn g·∫ßn b·ªù bi·ªÉn", next: "find_sea_food", effects: { thirst: -15, hunger: -10 } }
                ]
            },
            explore_forest: {
                text: "B·∫°n b∆∞·ªõc v√†o khu r·ª´ng r·∫≠m, n∆°i c√¢y c·ªëi cao l·ªõn che k√≠n √°nh s√°ng. Ti·∫øng chim l·∫° v√† c√¥n tr√πng r√¢m ran khi·∫øn b·∫°n cƒÉng th·∫≥ng. ƒêi ƒë∆∞·ª£c m·ªôt l√∫c, b·∫°n nghe ti·∫øng n∆∞·ªõc ch·∫£y ƒë√¢u ƒë√≥, nh∆∞ng c≈©ng c·∫£m nh·∫≠n ƒë∆∞·ª£c √°nh m·∫Øt c·ªßa th√∫ hoang ƒëang r√¨nh r·∫≠p. B·∫°n t·ª± h·ªèi: 'N√™n t√¨m n∆∞·ªõc hay c·∫©n th·∫≠n v·ªõi th√∫ d·ªØ?'",
                timeLimit: 45,
                choices: [
                    { text: "T√¨m ngu·ªìn n∆∞·ªõc", next: "find_water", effects: { thirst: -10, health: -5 } },
                    { text: "Ch·∫°m tr√°n th√∫ hoang", next: "encounter_beast", effects: { morale: -10, health: -10 } },
                    { text: "Thu th·∫≠p t√†i nguy√™n r·ª´ng", next: "gather_forest", effects: { hunger: -10, thirst: -10, inventory: { wood: 3, vine: 2 } } }
                ]
            },
            gather_forest: {
                text: "B·∫°n thu th·∫≠p ƒë∆∞·ª£c 3 kh√∫c g·ªó v√† 2 ƒëo·∫°n d√¢y leo t·ª´ r·ª´ng. Nh∆∞ng trong l√∫c ch·∫∑t c√¢y, b·∫°n s∆° √Ω l√†m tay b·ªã x∆∞·ªõc, m√°u r·ªâ ra. B·∫°n nghƒ©: 'M√¨nh c·∫ßn c·∫©n th·∫≠n h∆°n, nh∆∞ng √≠t nh·∫•t ƒë√£ c√≥ √≠t t√†i nguy√™n.' C√°i ƒë√≥i b·∫Øt ƒë·∫ßu khi·∫øn b·ª•ng b·∫°n r√©o l√™n.",
                choices: [
                    { text: "T√¨m ngu·ªìn n∆∞·ªõc", next: "find_water", effects: { thirst: -10, health: -5 } },
                    { text: "T√¨m tr√°i c√¢y trong r·ª´ng", next: "find_fruit", effects: { hunger: -10, thirst: -10 } },
                    { text: "Quay l·∫°i b·ªù bi·ªÉn", next: "camp_beach", effects: { morale: 5, thirst: -10 } }
                ]
            },
            find_water: {
                text: "B·∫°n l·∫ßn theo ti·∫øng n∆∞·ªõc, ƒë·∫øn m·ªôt con su·ªëi nh·ªè trong r·ª´ng. N∆∞·ªõc trong veo, nh∆∞ng b·∫°n lo l·∫Øng: 'N√≥ c√≥ s·∫°ch kh√¥ng? N·∫øu u·ªëng nh·∫ßm, m√¨nh s·∫Ω g·∫∑p r·∫Øc r·ªëi...' B·∫°n nh√¨n b·ªô ƒë√°nh l·ª≠a trong ba l√¥, nghƒ© ƒë·∫øn vi·ªác ƒëun s√¥i n∆∞·ªõc.",
                choices: [
                    { text: "ƒêun s√¥i n∆∞·ªõc ƒë·ªÉ u·ªëng", next: "boil_water", effects: { thirst: -10, inventory: { wood: -1 } } },
                    { text: "U·ªëng tr·ª±c ti·∫øp", next: "drink_raw", effects: { thirst: 30, health: -20 } },
                    { text: "Thu th·∫≠p n∆∞·ªõc v√†o v·ªè s√≤", next: "collect_water", effects: { inventory: { shell: 2, water: 2 }, thirst: -10 } }
                ]
            },
            boil_water: {
                text: "B·∫°n d√πng b·ªô ƒë√°nh l·ª≠a v√† √≠t g·ªó ƒë·ªÉ ƒëun s√¥i n∆∞·ªõc. N∆∞·ªõc n√≥ng l√†m b·∫°n c·∫£m th·∫•y an t√¢m. Sau khi u·ªëng, b·∫°n c·∫£m th·∫•y kh√°t d·ªãu ƒëi, nh∆∞ng c√°i ƒë√≥i v·∫´n dai d·∫≥ng. B·∫°n t·ª± nh·ªß: 'M√¨nh c·∫ßn t√¨m th·ª©c ƒÉn, ho·∫∑c √≠t nh·∫•t l√† m·ªôt n∆°i an to√†n ƒë·ªÉ ngh·ªâ.'",
                effects: { thirst: 50, morale: 10 },
                choices: [
                    { text: "T√¨m tr√°i c√¢y trong r·ª´ng", next: "find_fruit", effects: { hunger: -10, thirst: -10 } },
                    { text: "Quay l·∫°i b·ªù bi·ªÉn l·∫≠p tr·∫°i", next: "camp_beach", effects: { morale: 10, thirst: -10 } },
                    { text: "Kh√°m ph√° s√¢u h∆°n v√†o r·ª´ng", next: "deep_forest", effects: { health: -10, thirst: -10 } }
                ]
            },
            drink_raw: {
                text: "B·∫°n u·ªëng tr·ª±c ti·∫øp t·ª´ su·ªëi, c·∫£m th·∫•y s·∫£ng kho√°i ngay l·∫≠p t·ª©c. Nh∆∞ng v√†i gi·ªù sau, b·ª•ng b·∫°n qu·∫∑n ƒëau. 'Ch·∫øt ti·ªát... n∆∞·ªõc c√≥ v·∫•n ƒë·ªÅ!' B·∫°n y·∫øu ƒëi r√µ r·ªát, nh∆∞ng v·∫´n c·ªë l√™ b∆∞·ªõc.",
                effects: { health: -30, morale: -20 },
                choices: [
                    { text: "Ngh·ªâ ng∆°i ƒë·ªÉ h·ªìi ph·ª•c", next: "rest_recover", effects: { health: 10, morale: 5 } },
                    { text: "T√¨m tr√°i c√¢y ƒë·ªÉ ƒÉn", next: "find_fruit", effects: { hunger: -10, thirst: -10 } },
                    { text: "Quay l·∫°i b·ªù bi·ªÉn", next: "camp_beach", effects: { morale: 5, thirst: -10 } }
                ]
            },
            collect_water: {
                text: "B·∫°n d√πng v√†i v·ªè s√≤ t√¨m ƒë∆∞·ª£c g·∫ßn su·ªëi ƒë·ªÉ ch·ª©a n∆∞·ªõc, c·∫©n th·∫≠n mang theo. 'C√°i n√†y s·∫Ω h·ªØu √≠ch sau,' b·∫°n nghƒ©. Tuy nhi√™n, b·∫°n v·∫´n c·∫ßn u·ªëng g√¨ ƒë√≥ ngay ƒë·ªÉ c·∫ßm c·ª±.",
                effects: { morale: 10 },
                choices: [
                    { text: "ƒêun s√¥i n∆∞·ªõc ƒë·ªÉ u·ªëng", next: "boil_water", effects: { thirst: -10, inventory: { wood: -1 } } },
                    { text: "T√¨m tr√°i c√¢y trong r·ª´ng", next: "find_fruit", effects: { hunger: -10, thirst: -10 } },
                    { text: "Quay l·∫°i b·ªù bi·ªÉn", next: "camp_beach", effects: { morale: 5, thirst: -10 } }
                ]
            },
            encounter_beast: {
                text: "M·ªôt con l·ª£n r·ª´ng kh·ªïng l·ªì xu·∫•t hi·ªán, m·∫Øt ƒë·ªè r·ª±c. N√≥ g·∫ßm g·ª´, chu·∫©n b·ªã t·∫•n c√¥ng. B·∫°n n·∫Øm ch·∫∑t con dao nh·ªè, nh∆∞ng n√≥ kh√¥ng ƒë·ªß ƒë·ªÉ ƒë·ªëi ƒë·∫ßu. 'M√¨nh c·∫ßn v≈© kh√≠ t·ªët h∆°n... ho·∫∑c ch·∫°y!' Tim b·∫°n ƒë·∫≠p th√¨nh th·ªãch.",
                timeLimit: 30,
                choices: [
                    { text: "Ch·∫°y tho√°t", next: "escape_beast", effects: { health: -10, morale: -10 } },
                    { text: "Ch·∫ø v≈© kh√≠ th√¥ s∆°", next: "craft_weapon", effects: { health: -15, inventory: { wood: -1, stone: -1 } } },
                    { text: "ƒê·ªëi ƒë·∫ßu v·ªõi con dao nh·ªè", next: "fight_beast", effects: { health: -50, morale: -20 } }
                ]
            },
            escape_beast: {
                text: "B·∫°n ch·∫°y th·ª•c m·∫°ng, c√†nh c√¢y qu·∫•t v√†o m·∫∑t ƒëau r√°t. L·ª£n r·ª´ng b·ªè cu·ªôc, nh∆∞ng b·∫°n ki·ªát s·ª©c v√† ho·∫£ng lo·∫°n. 'M√¨nh kh√¥ng th·ªÉ b·∫•t c·∫©n th·∫ø n√†y n·ªØa...' B·∫°n c·∫ßn l·∫•y l·∫°i b√¨nh tƒ©nh.",
                choices: [
                    { text: "T√¨m ngu·ªìn n∆∞·ªõc", next: "find_water", effects: { thirst: -10, health: -5 } },
                    { text: "Quay l·∫°i b·ªù bi·ªÉn", next: "camp_beach", effects: { morale: 5, thirst: -10 } },
                    { text: "Ngh·ªâ ng∆°i", next: "rest_recover", effects: { health: 10, morale: 5 } }
                ]
            },
            craft_weapon: {
                text: "B·∫°n d√πng dao nh·ªè, g·ªó, v√† ƒë√° ƒë·ªÉ ch·∫ø m·ªôt c√¢y gi√°o th√¥ s∆°. L·ª£n r·ª´ng lao t·ªõi, nh∆∞ng b·∫°n ƒë√¢m tr√∫ng n√≥, khi·∫øn n√≥ b·ªè ch·∫°y. B·∫°n th·ªü ph√†o: 'May qu√°, nh∆∞ng m√¨nh m·ªát l·∫Øm r·ªìi.' C√¢y gi√°o gi·ªù l√† t√†i s·∫£n qu√Ω gi√°.",
                effects: { morale: 20, inventory: { tools: ["Gi√°o g·ªó"] } },
                choices: [
                    { text: "SƒÉn l·ª£n r·ª´ng ƒë·ªÉ l·∫•y th·ªãt", next: "hunt_pig", effects: { health: -20, hunger: -10 } },
                    { text: "T√¨m ngu·ªìn n∆∞·ªõc", next: "find_water", effects: { thirst: -10, health: -5 } },
                    { text: "Quay l·∫°i b·ªù bi·ªÉn", next: "camp_beach", effects: { morale: 5, thirst: -10 } }
                ]
            },
            fight_beast: {
                text: "B·∫°n ƒë·ªëi ƒë·∫ßu l·ª£n r·ª´ng v·ªõi con dao nh·ªè, nh∆∞ng n√≥ qu√° m·∫°nh. M·ªôt c√∫ h√∫c khi·∫øn b·∫°n ng√£, v√† m√≥ng vu·ªët c·ªßa n√≥ x√© to·∫°c b·∫°n. M·ªçi th·ª© ch√¨m v√†o b√≥ng t·ªëi.",
                ending: "Bad Ending: B·ªã l·ª£n r·ª´ng gi·∫øt, h√†nh tr√¨nh k·∫øt th√∫c."
            },
            hunt_pig: {
                text: "V·ªõi c√¢y gi√°o, b·∫°n l·∫ßn theo d·∫•u v·∫øt l·ª£n r·ª´ng. Sau m·ªôt cu·ªôc sƒÉn cƒÉng th·∫≥ng, b·∫°n h·∫° ƒë∆∞·ª£c n√≥, thu ƒë∆∞·ª£c th·ªãt t∆∞∆°i. B·∫°n t·ª± h√†o: 'ƒê√¢y l√† b·ªØa ƒÉn ngon nh·∫•t t·ª´ tr∆∞·ªõc ƒë·∫øn gi·ªù!' Nh∆∞ng sƒÉn b·∫Øn l√†m b·∫°n ki·ªát s·ª©c.",
                effects: { hunger: 50, morale: 20, inventory: { fish: 3 } },
                choices: [
                    { text: "N∆∞·ªõng th·ªãt v√† ƒÉn", next: "cook_meat", effects: { hunger: 30, morale: 10, inventory: { wood: -1 } } },
                    { text: "Quay l·∫°i b·ªù bi·ªÉn l·∫≠p tr·∫°i", next: "camp_beach", effects: { morale: 5, thirst: -10 } },
                    { text: "Kh√°m ph√° s√¢u h∆°n v√†o r·ª´ng", next: "deep_forest", effects: { health: -10, thirst: -10 } }
                ]
            },
            cook_meat: {
                text: "B·∫°n d√πng b·ªô ƒë√°nh l·ª≠a ƒë·ªÉ n∆∞·ªõng th·ªãt. M√πi th∆°m l√†m b·∫°n ch·∫£y n∆∞·ªõc mi·∫øng. Sau khi ƒÉn, b·∫°n c·∫£m th·∫•y no n√™ v√† tinh th·∫ßn ph·∫•n ch·∫•n. 'M√¨nh c√≥ th·ªÉ l√†m ƒë∆∞·ª£c... m√¨nh s·∫Ω s·ªëng s√≥t!'",
                effects: { hunger: 20, morale: 10 },
                choices: [
                    { text: "L·∫≠p tr·∫°i trong r·ª´ng", next: "camp_forest", effects: { morale: 10, thirst: -10 } },
                    { text: "Quay l·∫°i b·ªù bi·ªÉn", next: "camp_beach", effects: { morale: 5, thirst: -10 } },
                    { text: "Kh√°m ph√° s√¢u h∆°n", next: "deep_forest", effects: { health: -10, thirst: -10 } }
                ]
            },
            camp_beach: {
                text: "B·∫°n l·∫≠p tr·∫°i g·∫ßn b·ªù bi·ªÉn, d·ª±ng m·ªôt l·ªÅu t·∫°m b·∫±ng l√° v√† g·ªó. Ng·ªçn l·ª≠a tr·∫°i ch√°y s√°ng, l√†m b·∫°n c·∫£m th·∫•y an to√†n h∆°n. B·∫°n nghƒ©: 'M√¨nh c·∫ßn th·ª©c ƒÉn v√† n∆∞·ªõc, nh∆∞ng √≠t nh·∫•t t·ªëi nay c√≥ ch·ªó ngh·ªâ.' Gi√≥ bi·ªÉn mang theo m√πi mu·ªëi, nh∆∞ng c√°i kh√°t v·∫´n dai d·∫≥ng.",
                effects: { morale: 10 },
                choices: [
                    { text: "X√¢y nh√† t·∫°m ki√™n c·ªë h∆°n", next: "build_shelter", effects: { health: -20, inventory: { wood: -3, leaf: -2 } } },
                    { text: "T√¨m th·ª©c ƒÉn t·ª´ bi·ªÉn", next: "find_sea_food", effects: { thirst: -15, hunger: -10 } },
                    { text: "Kh√°m ph√° khu r·ª´ng", next: "explore_forest", effects: { thirst: -10, hunger: -5 } }
                ]
            },
            build_shelter: {
                text: "B·∫°n d√πng g·ªó v√† l√° ƒë·ªÉ x√¢y m·ªôt ng√¥i nh√† t·∫°m ki√™n c·ªë. M·ªì h√¥i nh·ªÖ nh·∫°i, nh∆∞ng b·∫°n c·∫£m th·∫•y t·ª± h√†o: 'C√°i n√†y s·∫Ω gi·ªØ m√¨nh an to√†n qua ƒë√™m.' Tinh th·∫ßn b·∫°n l√™n cao, nh∆∞ng c∆° th·ªÉ m·ªát m·ªèi.",
                effects: { morale: 20, health: -10 },
                choices: [
                    { text: "Ngh·ªâ ng∆°i trong nh√† t·∫°m", next: "rest_shelter", effects: { health: 20, morale: 10 } },
                    { text: "T√¨m th·ª©c ƒÉn t·ª´ bi·ªÉn", next: "find_sea_food", effects: { thirst: -15, hunger: -10 } },
                    { text: "Kh√°m ph√° khu r·ª´ng", next: "explore_forest", effects: { thirst: -10, hunger: -5 } }
                ]
            },
            rest_shelter: {
                text: "B·∫°n n·∫±m trong nh√† t·∫°m, nghe ti·∫øng s√≥ng v·ªó. C∆° th·ªÉ b·∫°n h·ªìi ph·ª•c, v√† tinh th·∫ßn ·ªïn ƒë·ªãnh h∆°n. 'M√¨nh c·∫ßn l·∫≠p k·∫ø ho·∫°ch d√†i h∆°i... ph·∫£i r·ªùi kh·ªèi ƒë·∫£o n√†y.' B·∫°n b·∫Øt ƒë·∫ßu nghƒ© ƒë·∫øn vi·ªác ch·∫ø b√® ho·∫∑c g·ª≠i t√≠n hi·ªáu.",
                choices: [
                    { text: "Ch·∫ø b√® ƒë·ªÉ r·ªùi ƒë·∫£o", next: "build_raft", effects: { health: -20, inventory: { wood: -5, vine: -3 } } },
                    { text: "T·∫°o t√≠n hi·ªáu kh√≥i", next: "signal_smoke", effects: { morale: 10, inventory: { wood: -2 } } },
                    { text: "T√¨m th·ª©c ƒÉn t·ª´ bi·ªÉn", next: "find_sea_food", effects: { thirst: -15, hunger: -10 } }
                ]
            },
            find_sea_food: {
                text: "B·∫°n l·ªôi xu·ªëng bi·ªÉn, d√πng dao nh·ªè ƒë·ªÉ b·∫Øt c√° v√† nh·∫∑t v·ªè s√≤. Nh∆∞ng m·ªôt con s·ª©a c·ªç v√†o ch√¢n b·∫°n, g√¢y ng·ª©a r√°t. B·∫°n thu ƒë∆∞·ª£c √≠t c√°, nh∆∞ng c∆° th·ªÉ y·∫øu ƒëi. 'M√¨nh c·∫ßn c·∫©n th·∫≠n h∆°n... bi·ªÉn kh√¥ng an to√†n nh∆∞ t∆∞·ªüng.'",
                effects: { health: -20, hunger: 20, inventory: { fish: 2, shell: 1 } },
                choices: [
                    { text: "N∆∞·ªõng c√° ƒë·ªÉ ƒÉn", next: "cook_fish", effects: { hunger: 30, morale: 10, inventory: { wood: -1 } } },
                    { text: "Quay l·∫°i tr·∫°i ngh·ªâ ng∆°i", next: "rest_shelter", effects: { health: 20, morale: 10 } },
                    { text: "Kh√°m ph√° khu r·ª´ng", next: "explore_forest", effects: { thirst: -10, hunger: -5 } }
                ]
            },
            cook_fish: {
                text: "B·∫°n n∆∞·ªõng c√° tr√™n l·ª≠a tr·∫°i, m√πi th∆°m l√†m b·∫°n qu√™n ƒëi c√°i ƒëau t·ª´ v·∫øt s·ª©a. Sau khi ƒÉn, b·∫°n c·∫£m th·∫•y no v√† tinh th·∫ßn t·ªët h∆°n. 'M√¨nh c·∫ßn m·ªôt k·∫ø ho·∫°ch d√†i h∆°i... c√≥ l·∫Ω l√† ch·∫ø b√® ho·∫∑c t√≠n hi·ªáu.'",
                effects: { hunger: 20, morale: 10 },
                choices: [
                    { text: "Ch·∫ø b√® ƒë·ªÉ r·ªùi ƒë·∫£o", next: "build_raft", effects: { health: -20, inventory: { wood: -5, vine: -3 } } },
                    { text: "T·∫°o t√≠n hi·ªáu kh√≥i", next: "signal_smoke", effects: { morale: 10, inventory: { wood: -2 } } },
                    { text: "Kh√°m ph√° s√¢u h∆°n v√†o r·ª´ng", next: "deep_forest", effects: { health: -10, thirst: -10 } }
                ]
            },
            deep_forest: {
                text: "B·∫°n ƒëi s√¢u v√†o r·ª´ng, ƒë·∫øn m·ªôt khu v·ª±c cao. T·ª´ ƒë√¢y, b·∫°n th·∫•y to√†n c·∫£nh ƒë·∫£o: b√£i bi·ªÉn, r·ª´ng r·∫≠m, v√† m·ªôt c·ªôt kh√≥i m·ªèng ·ªü ph√≠a xa. 'C√≥ ng∆∞·ªùi kh√°c tr√™n ƒë·∫£o n√†y sao?' b·∫°n t·ª± h·ªèi. Nh∆∞ng ƒë∆∞·ªùng xu·ªëng r·∫•t d·ªëc, v√† b·∫°n c·∫£m th·∫•y ki·ªát s·ª©c.",
                effects: { health: -15, morale: 15 },
                choices: [
                    { text: "ƒêi theo t√≠n hi·ªáu kh√≥i", next: "follow_smoke", effects: { health: -10, thirst: -10 } },
                    { text: "Kh√°m ph√° hang ƒë·ªông g·∫ßn ƒë√≥", next: "explore_cave", effects: { morale: -10, thirst: -10 } },
                    { text: "Quay l·∫°i tr·∫°i", next: "rest_shelter", effects: { health: 20, morale: 10 } }
                ]
            },
            follow_smoke: {
                text: "B·∫°n l·∫ßn theo c·ªôt kh√≥i, ƒë·∫øn m·ªôt khu tr·∫°i b·ªè hoang. M·ªôt ng∆∞·ªùi s·ªëng s√≥t kh√°c xu·∫•t hi·ªán, √°nh m·∫Øt s·∫Øc l·∫°nh: 'Ai ƒë·∫•y? ƒê·∫£o n√†y kh√¥ng ƒë·ªß ch·ªó cho c·∫£ hai!' B·∫°n ph·∫£i quy·∫øt ƒë·ªãnh c√°ch ƒë·ªëi ph√≥.",
                timeLimit: 30,
                choices: [
                    { text: "Thuy·∫øt ph·ª•c h·ª£p t√°c", next: "ally_survivor", effects: { morale: 20 } },
                    { text: "ƒê·ªëi ƒë·∫ßu", next: "fight_survivor", effects: { health: -30, morale: -20 } },
                    { text: "R√∫t lui l·∫∑ng l·∫Ω", next: "retreat_smoke", effects: { morale: -10, thirst: -10 } }
                ]
            },
            ally_survivor: {
                text: "B·∫°n thuy·∫øt ph·ª•c ng∆∞·ªùi s·ªëng s√≥t, t√™n l√† Kai. Anh ta chia s·∫ª m·ªôt m·∫£nh g∆∞∆°ng v·ª° v√† n√≥i: 'D√πng c√°i n√†y ƒë·ªÉ b√°o hi·ªáu t√†u bay qua.' B·∫°n c·∫£m th·∫•y hy v·ªçng: 'C√≥ ƒë·ªìng minh, m√¨nh s·∫Ω m·∫°nh h∆°n!'",
                effects: { inventory: { tools: ["G∆∞∆°ng v·ª°"] }, morale: 20 },
                choices: [
                    { text: "T·∫°o t√≠n hi·ªáu kh√≥i v·ªõi g∆∞∆°ng", next: "signal_mirror", effects: { morale: 10, inventory: { wood: -2 } } },
                    { text: "Ch·∫ø b√® c√πng Kai", next: "build_raft_ally", effects: { health: -15, inventory: { wood: -5, vine: -3 } } },
                    { text: "Ngh·ªâ ng∆°i v√† l√™n k·∫ø ho·∫°ch", next: "rest_shelter", effects: { health: 20, morale: 10 } }
                ]
            },
            fight_survivor: {
                text: "B·∫°n ƒë·ªëi ƒë·∫ßu Kai, nh∆∞ng anh ta m·∫°nh h∆°n b·∫°n nghƒ©. M·ªôt nh√°t dao khi·∫øn b·∫°n ng√£ g·ª•c, v√† b√≥ng t·ªëi bao tr√πm.",
                ending: "Bad Ending: B·ªã ng∆∞·ªùi s·ªëng s√≥t gi·∫øt, h√†nh tr√¨nh k·∫øt th√∫c."
            },
            retreat_smoke: {
                text: "B·∫°n r√∫t lui, nh∆∞ng Kai ph√°t hi·ªán v√† ƒëu·ªïi theo. Trong l√∫c ch·∫°y tr·ªën, b·∫°n v·∫•p ng√£ v√† b·ªã th∆∞∆°ng n·∫∑ng. B·∫°n l√™ v·ªÅ tr·∫°i, nh∆∞ng tinh th·∫ßn suy s·ª•p.",
                effects: { health: -30, morale: -20 },
                choices: [
                    { text: "Ngh·ªâ ng∆°i ƒë·ªÉ h·ªìi ph·ª•c", next: "rest_shelter", effects: { health: 20, morale: 10 } },
                    { text: "T·∫°o t√≠n hi·ªáu kh√≥i", next: "signal_smoke", effects: { morale: 10, inventory: { wood: -2 } } },
                    { text: "Ch·∫ø b√® ƒë·ªÉ r·ªùi ƒë·∫£o", next: "build_raft", effects: { health: -20, inventory: { wood: -5, vine: -3 } } }
                ]
            },
            explore_cave: {
                text: "B·∫°n b∆∞·ªõc v√†o hang ƒë·ªông l·∫°nh l·∫Ωo, n∆°i nh·ªØng b·ª©c v·∫Ω c·ªï ƒë·∫°i tr√™n t∆∞·ªùng k·ªÉ v·ªÅ c∆∞ d√¢n c≈© c·ªßa ƒë·∫£o. B·∫°n t√¨m th·∫•y m·ªôt di v·∫≠t ‚Äì m·ªôt m·∫£nh ng·ªçc kh·∫Øc ch·ªØ: 'K·∫ª s·ªëng s√≥t s·∫Ω t√¨m th·∫•y √°nh s√°ng.' Nh∆∞ng b√≥ng t·ªëi trong hang l√†m b·∫°n run s·ª£.",
                effects: { morale: -10, inventory: { tools: ["M·∫£nh ng·ªçc c·ªï"] } },
                choices: [
                    { text: "Gi·∫£i m√£ di v·∫≠t", next: "decode_relic", effects: { morale: 20, thirst: -10 } },
                    { text: "R·ªùi hang ƒë·ªông", next: "rest_shelter", effects: { health: 20, morale: 10 } },
                    { text: "Kh√°m ph√° s√¢u h∆°n", next: "deep_cave", effects: { health: -15, morale: -15 } }
                ]
            },
            decode_relic: {
                text: "B·∫°n nghi√™n c·ª©u m·∫£nh ng·ªçc, nh·∫≠n ra n√≥ ch·ªâ ƒë∆∞·ªùng ƒë·∫øn m·ªôt b√£i ƒë√° ng·∫ßm ‚Äì n∆°i c√≥ th·ªÉ g·ª≠i t√≠n hi·ªáu m·∫°nh h∆°n. 'ƒê√¢y l√† ch√¨a kh√≥a ƒë·ªÉ ƒë∆∞·ª£c c·ª©u!' b·∫°n reo l√™n. Tinh th·∫ßn b·∫°n tƒÉng cao, nh∆∞ng c∆° th·ªÉ m·ªát m·ªèi.",
                effects: { morale: 30 },
                choices: [
                    { text: "T·∫°o t√≠n hi·ªáu kh√≥i ·ªü b√£i ƒë√° ng·∫ßm", next: "signal_reef", effects: { morale: 10, inventory: { wood: -2 } } },
                    { text: "Ch·∫ø b√® ƒë·ªÉ r·ªùi ƒë·∫£o", next: "build_raft", effects: { health: -20, inventory: { wood: -5, vine: -3 } } },
                    { text: "Ngh·ªâ ng∆°i", next: "rest_shelter", effects: { health: 20, morale: 10 } }
                ]
            },
            deep_cave: {
                text: "B·∫°n ƒëi s√¢u h∆°n, nh∆∞ng hang ƒë·ªông s·ª•p ƒë·ªï m·ªôt ph·∫ßn. B·∫°n b·ªã m·∫Øc k·∫πt, kh√¥ng l·ªëi tho√°t. B√≥ng t·ªëi nu·ªët ch·ª≠ng b·∫°n, v√† tinh th·∫ßn s·ª•p ƒë·ªï.",
                ending: "Bad Ending: M·∫Øc k·∫πt trong hang, kh√¥ng ai t√¨m th·∫•y b·∫°n."
            },
            signal_smoke: {
                text: "B·∫°n t·∫°o t√≠n hi·ªáu kh√≥i b·∫±ng g·ªó v√† l√°. Kh√≥i b·ªëc cao, nh∆∞ng kh√¥ng c√≥ d·∫•u hi·ªáu t√†u hay m√°y bay. B·∫°n nghƒ©: 'M√¨nh c·∫ßn ki√™n nh·∫´n, ho·∫∑c th·ª≠ c√°ch kh√°c.' Tinh th·∫ßn b·∫°n dao ƒë·ªông.",
                effects: { morale: 5 },
                choices: [
                    { text: "Ti·∫øp t·ª•c g·ª≠i t√≠n hi·ªáu", next: "keep_signaling", effects: { morale: 5, inventory: { wood: -2 } } },
                    { text: "Ch·∫ø b√® ƒë·ªÉ r·ªùi ƒë·∫£o", next: "build_raft", effects: { health: -20, inventory: { wood: -5, vine: -3 } } },
                    { text: "Ngh·ªâ ng∆°i", next: "rest_shelter", effects: { health: 20, morale: 10 } }
                ]
            },
            keep_signaling: {
                text: "B·∫°n ti·∫øp t·ª•c g·ª≠i t√≠n hi·ªáu kh√≥i. Sau nhi·ªÅu gi·ªù, m·ªôt chi·∫øc tr·ª±c thƒÉng xu·∫•t hi·ªán. H·ªç nh√¨n th·∫•y b·∫°n v√† ƒë√°p xu·ªëng. B·∫°n ƒë∆∞·ª£c c·ª©u! 'M√¨nh ƒë√£ l√†m ƒë∆∞·ª£c... m√¨nh s·ªëng s√≥t!'",
                ending: "Rescue Ending: ƒê∆∞·ª£c ƒë·ªôi c·ª©u h·ªô t√¨m th·∫•y, b·∫°n tr·ªü v·ªÅ an to√†n."
            },
            signal_mirror: {
                text: "B·∫°n d√πng g∆∞∆°ng v·ª° ƒë·ªÉ ph·∫£n chi·∫øu √°nh s√°ng m·∫∑t tr·ªùi, k·∫øt h·ª£p v·ªõi kh√≥i. M·ªôt t√†u tu·∫ßn tra nh·∫≠n t√≠n hi·ªáu v√† ƒë·∫øn c·ª©u b·∫°n. B·∫°n √¥m l·∫•y Kai: 'Ch√∫ng ta ƒë√£ l√†m ƒë∆∞·ª£c!'",
                ending: "Rescue Ending: Nh·ªù g∆∞∆°ng v√† kh√≥i, b·∫°n ƒë∆∞·ª£c c·ª©u v·ªÅ ƒë·∫•t li·ªÅn."
            },
            signal_reef: {
                text: "B·∫°n ƒë·∫øn b√£i ƒë√° ng·∫ßm, d√πng m·∫£nh ng·ªçc ƒë·ªÉ ƒë·ªãnh v·ªã v√† t·∫°o t√≠n hi·ªáu kh√≥i. M·ªôt m√°y bay ph√°t hi·ªán, v√† ƒë·ªôi c·ª©u h·ªô ƒë·∫øn ngay. B·∫°n mang theo m·∫£nh ng·ªçc, kh√°m ph√° ra b√≠ m·∫≠t c·ªßa ƒë·∫£o sau n√†y.",
                ending: "Secret Ending: ƒê∆∞·ª£c c·ª©u v√† kh√°m ph√° b√≠ m·∫≠t c·ªï x∆∞a c·ªßa ƒë·∫£o."
            },
            build_raft: {
                text: () => {
                    if (inventory.wood >= 5 && inventory.vine >= 3 && inventory.fish >= 2) {
                        return {
                            text: "B·∫°n d√πng g·ªó, d√¢y leo, v√† d·ª± tr·ªØ c√° ƒë·ªÉ ch·∫ø b√®. Sau nhi·ªÅu ng√†y l√™nh ƒë√™nh, b·∫°n t√¨m th·∫•y ƒë·∫•t li·ªÅn. 'M√¨nh ƒë√£ s·ªëng s√≥t... v√† t·ª± do!'",
                            ending: "Happy Ending: T·ª± ch·∫ø b√®, r·ªùi ƒë·∫£o an to√†n."
                        };
                    } else {
                        return {
                            text: "B·∫°n c·ªë ch·∫ø b√®, nh∆∞ng thi·∫øu t√†i nguy√™n. B√® v·ª° tan gi·ªØa bi·ªÉn, v√† b·∫°n ch√¨m v√†o b√≥ng t·ªëi.",
                            ending: "Bad Ending: B√® th·∫•t b·∫°i, b·∫°n ch·∫øt gi·ªØa bi·ªÉn."
                        };
                    }
                }
            },
            build_raft_ally: {
                text: "B·∫°n v√† Kai c√πng ch·∫ø b√®, chia s·∫ª t√†i nguy√™n. B√® ch·∫Øc ch·∫Øn, v√† c·∫£ hai l√™nh ƒë√™nh ƒë·∫øn ƒë·∫•t li·ªÅn. Kai n·∫Øm tay b·∫°n: 'Ch√∫ng ta l√† ƒë·ªôi tuy·ªát v·ªùi!'",
                ending: "Happy Ending: C√πng ƒë·ªìng minh, b·∫°n r·ªùi ƒë·∫£o th√†nh c√¥ng."
            },
            rest_recover: {
                text: "B·∫°n ngh·ªâ ng∆°i, c·ªë g·∫Øng l·∫•y l·∫°i s·ª©c. Nh∆∞ng n·∫øu kh√¥ng t√¨m th·ª©c ƒÉn v√† n∆∞·ªõc, b·∫°n s·∫Ω kh√¥ng c·∫ßm c·ª± l√¢u. B·∫°n vi·∫øt v√†o nh·∫≠t k√Ω: 'Ng√†y mai, m√¨nh ph·∫£i m·∫°nh m·∫Ω h∆°n.'",
                effects: { health: 10, morale: 5 },
                choices: [
                    { text: "Kh√°m ph√° khu r·ª´ng", next: "explore_forest", effects: { thirst: -10, hunger: -5 } },
                    { text: "T√¨m th·ª©c ƒÉn t·ª´ bi·ªÉn", next: "find_sea_food", effects: { thirst: -15, hunger: -10 } },
                    { text: "L·∫≠p tr·∫°i g·∫ßn b·ªù bi·ªÉn", next: "camp_beach", effects: { morale: 10, thirst: -10 } }
                ]
            },
            camp_forest: {
                text: "B·∫°n l·∫≠p tr·∫°i trong r·ª´ng, d√πng l√° v√† g·ªó ƒë·ªÉ l√†m l·ªÅu. L·ª≠a tr·∫°i ch√°y s√°ng, nh∆∞ng ti·∫øng th√∫ hoang khi·∫øn b·∫°n kh√≥ ng·ªß. 'M√¨nh c·∫ßn chu·∫©n b·ªã t·ªët h∆°n... ƒë·∫£o n√†y kh√¥ng th√¢n thi·ªán.'",
                effects: { morale: 10 },
                choices: [
                    { text: "Ch·∫ø b√® ƒë·ªÉ r·ªùi ƒë·∫£o", next: "build_raft", effects: { health: -20, inventory: { wood: -5, vine: -3 } } },
                    { text: "T·∫°o t√≠n hi·ªáu kh√≥i", next: "signal_smoke", effects: { morale: 10, inventory: { wood: -2 } } },
                    { text: "Kh√°m ph√° s√¢u h∆°n", next: "deep_forest", effects: { health: -10, thirst: -10 } }
                ]
            },
            time_out: {
                text: "B·∫°n ch·∫ßn ch·ª´ qu√° l√¢u. C∆°n kh√°t v√† ƒë√≥i khi·∫øn b·∫°n ki·ªát s·ª©c. B·∫°n ng√£ xu·ªëng c√°t, v√† b√≥ng t·ªëi bao tr√πm.",
                ending: "Bad Ending: Ki·ªát s·ª©c, b·∫°n ch·∫øt tr√™n ƒë·∫£o."
            }
        };

        let currentNode = "start";
        let timeLeft = 0;
        let timerInterval = null;

        function updateStats(effects) {
            if (effects) {
                stats.health = Math.max(0, Math.min(100, stats.health + (effects.health || 0)));
                stats.hunger = Math.max(0, Math.min(100, stats.hunger + (effects.hunger || 0)));
                stats.thirst = Math.max(0, Math.min(100, stats.thirst + (effects.thirst || 0)));
                stats.morale = Math.max(0, Math.min(100, stats.morale + (effects.morale || 0)));
                if (effects.inventory) {
                    for (let key in effects.inventory) {
                        inventory[key] = (inventory[key] || 0) + effects.inventory[key];
                        if (inventory[key] < 0) inventory[key] = 0;
                    }
                    if (effects.inventory.tools) {
                        inventory.tools.push(...effects.inventory.tools);
                    }
                }
            }

            document.getElementById("health").innerText = stats.health;
            document.getElementById("hunger").innerText = stats.hunger;
            document.getElementById("thirst").innerText = stats.thirst;
            document.getElementById("morale").innerText = stats.morale;

            let inventoryText = "T√†i nguy√™n: ";
            for (let key in inventory) {
                if (key !== "tools" && inventory[key] > 0) {
                    inventoryText += `${key}: ${inventory[key]}, `;
                }
            }
            inventoryText += `C√¥ng c·ª•: ${inventory.tools.join(", ")}`;
            document.getElementById("inventory").innerText = inventoryText;

            if (stats.health <= 0 || stats.hunger <= 0 || stats.thirst <= 0) {
                currentNode = "bad_ending";
                displayCurrentNode();
            } else if (stats.morale <= 0) {
                currentNode = "loop_ending";
                displayCurrentNode();
            }
        }

        function startTimer(limit) {
            if (timerInterval) clearInterval(timerInterval);
            timeLeft = limit;
            const timerElement = document.getElementById("timer");
            timerElement.innerText = `Th·ªùi gian c√≤n l·∫°i: ${timeLeft} gi√¢y`;
            timerInterval = setInterval(() => {
                timeLeft--;
                timerElement.innerText = `Th·ªùi gian c√≤n l·∫°i: ${timeLeft} gi√¢y`;
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    currentNode = "time_out";
                    displayCurrentNode();
                }
            }, 1000);
        }

        function displayCurrentNode() {
            let node = storyNodes[currentNode] || {
                text: "B·∫°n ki·ªát s·ª©c ho√†n to√†n, ng√£ xu·ªëng c√°t. H√≤n ƒë·∫£o n√†y ƒë√£ ƒë√°nh b·∫°i b·∫°n.",
                ending: "Bad Ending: Ch·∫øt v√¨ ki·ªát s·ª©c tr√™n ƒë·∫£o."
            };

            if (typeof node.text === "function") {
                node = node.text();
            }

            document.getElementById("story-text").innerHTML = node.text.replace(/\n/g, "<br>");
            const choicesContainer = document.getElementById("choices");
            const endingContainer = document.getElementById("ending");
            choicesContainer.innerHTML = "";
            endingContainer.innerText = "";

            if (node.timeLimit) {
                startTimer(node.timeLimit);
            } else {
                clearInterval(timerInterval);
                document.getElementById("timer").innerText = "";
            }

            if (node.effects) {
                updateStats(node.effects);
            }

            if (node.choices) {
                node.choices.forEach(choice => {
                    const button = document.createElement("button");
                    button.innerText = choice.text;
                    button.className = "choice-btn";
                    button.onclick = () => {
                        clearInterval(timerInterval);
                        currentNode = choice.next;
                        updateStats(choice.effects);
                        displayCurrentNode();
                    };
                    choicesContainer.appendChild(button);
                });
            } else {
                clearInterval(timerInterval);
                endingContainer.innerText = node.ending;
                const restartButton = document.createElement("button");
                restartButton.innerText = "Ch∆°i l·∫°i t·ª´ ƒë·∫ßu";
                restartButton.className = "choice-btn restart-btn";
                restartButton.onclick = () => {
                    if (node.ending === "Loop Ending: T√°i sinh v·ªõi k√Ω ·ª©c.") {
                        experience += 10;
                    }
                    stats = { health: 100, hunger: 100, thirst: 100, morale: 100 };
                    inventory = {
                        wood: 0, stone: 0, vine: 0, leaf: 0, fish: 0, fruit: 0, water: 0, shell: 0,
                        tools: ["Dao nh·ªè", "ƒê√°nh l·ª≠a", "2m d√¢y th·ª´ng"]
                    };
                    currentNode = "start";
                    updateStats();
                    displayCurrentNode();
                };
                choicesContainer.appendChild(restartButton);
            }
        }

        window.onload = () => {
            displayCurrentNode();
        };
    </script>
</body>
</html>